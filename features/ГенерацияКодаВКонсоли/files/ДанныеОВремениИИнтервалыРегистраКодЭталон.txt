Функция ПолучитьДанные(ДатаНачала, ДатаОкончания, ДолжностьПоШтатномуРасписанию)
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц();
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Запрос.УстановитьПараметр("ДолжностьПоШтатномуРасписанию", ДолжностьПоШтатномуРасписанию);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Сотрудники.Ссылка КАК Сотрудник,
	|	&ДатаНачала КАК Период
	|ПОМЕСТИТЬ ВТФильтрКадроваяИсторияСотрудниковСрезПоследних
	|ИЗ
	|	Справочник.Сотрудники КАК Сотрудники";
	Запрос.Выполнить();
	Измерения = Новый Массив();
	СоответствиеИзмерений = Новый Соответствие();
	СоответствиеИзмерений.Вставить("Период", "Период");
	Измерения.Добавить("Сотрудник");
	СоответствиеИзмерений.Вставить("Сотрудник", "Сотрудник");

	ОписаниеВТФильтр = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистраПоВременнойТаблице(
		"ВТФильтрКадроваяИсторияСотрудниковСрезПоследних",
		Измерения);
	ОписаниеВТФильтр.СоответствиеИзмеренийРегистраИзмерениямФильтра = СоответствиеИзмерений;
	ПараметрыПостроения = ЗарплатаКадрыПериодическиеРегистры.ПараметрыПостроенияДляСоздатьВТИмяРегистраСрез();

	ПараметрыПостроения.ИндексироватьПо = Новый Массив;





	ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.ОтборыПрименяемыеКСрезу, "ДолжностьПоШтатномуРасписанию", "=", ДолжностьПоШтатномуРасписанию);


	ЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраСрезПоследних(
		"КадроваяИсторияСотрудников",
		Запрос.МенеджерВременныхТаблиц,
		Ложь,
		ОписаниеВТФильтр,
		ПараметрыПостроения,
		"ВТКадроваяИсторияСотрудниковСрезПоследних");

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	КадроваяИсторияСотрудниковСрезПоследних.Сотрудник КАК Сотрудник,
	|	&ДатаНачала КАК ДатаНачала,
	|	&ДатаОкончания КАК ДатаОкончания
	|ПОМЕСТИТЬ ВТСотрудники
	|ИЗ
	|	ВТКадроваяИсторияСотрудниковСрезПоследних КАК КадроваяИсторияСотрудниковСрезПоследних";
	Запрос.Выполнить();
	Поля = Новый Массив();
	Поля.Добавить("НАДБАВКА");
	Поля.Добавить("ТАРИФНАЯСТАВКА");
	Поля.Добавить("ТАБЕЛЬНЫЙНОМЕР");
	Поля.Добавить("ФОТ");
	Поля.Добавить("СОТРУДНИК");
	ИмяВТФильтр = "ВТСотрудники";
	ФормироватьСПериодичностьДень = Истина;
	ИменаПолейФильтра = "Сотрудник,ДатаНачала";
	ОписаниеФильтра = КадровыйУчет.ОписательВременныхТаблицДляСоздатьВТКадровыеДанныеСотрудников(
		Запрос.МенеджерВременныхТаблиц,
		ИмяВТФильтр,
		ИменаПолейФильтра);
	ОписаниеФильтра.ИмяВТКадровыеДанныеСотрудников = "ВТДанныеСотрудников";
	ТолькоРазрешенные = Ложь;
	КадровыйУчет.СоздатьВТКадровыеДанныеСотрудников(
		ОписаниеФильтра,
		ТолькоРазрешенные,
		Поля,,
		ФормироватьСПериодичностьДень);

	ПараметрыПолученияДанных = УчетРабочегоВремениРасширенный.ПараметрыДляЗапросВТДанныеУчетаВремениИСостоянийСотрудников();
	ПараметрыПолученияДанных.ИмяВТСотрудники = "ВТСотрудники";
	ПараметрыПолученияДанных.ИмяВТРезультат = "ВТДанныеУчетаВремениСотрудников";
	ПараметрыПолученияДанных.РассчитыватьПлановоеВремя = Истина;


	ПараметрыПолученияДанных.ДатаНачала = ДатаНачала;
	ПараметрыПолученияДанных.МесяцДатаНачала = НачалоМесяца(ПараметрыПолученияДанных.ДатаНачала);
	ПараметрыПолученияДанных.ДатаОкончания = ДатаОкончания;
	ПараметрыПолученияДанных.МесяцДатаОкончания = КонецМесяца(ПараметрыПолученияДанных.ДатаОкончания);
	ПараметрыПолученияДанных.ДатаАктуальности = ДатаНачала;
	ПараметрыПолученияДанных.ПолучатьУсловияТрудаИТерритории = Ложь;



	УчетРабочегоВремениРасширенный.СоздатьВТДанныеУчетаВремениИСостоянийСотрудников(
		Запрос.МенеджерВременныхТаблиц,
		Ложь,
		ПараметрыПолученияДанных);

	Измерения = Новый Массив();
	СоответствиеИзмерений = Новый Соответствие();
	Измерения.Добавить("ДатаОкончания");
	СоответствиеИзмерений.Вставить("ДатаОкончания", "ДатаОкончания");
	Измерения.Добавить("ДатаНачала");
	СоответствиеИзмерений.Вставить("ДатаНачала", "ДатаНачала");
	Измерения.Добавить("Сотрудник");
	СоответствиеИзмерений.Вставить("Сотрудник", "Сотрудник");
	ОписаниеВТФильтр = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистраПоВременнойТаблице(
		"ВТСотрудники",
		Измерения);
	ОписаниеВТФильтр.СоответствиеИзмеренийРегистраИзмерениямФильтра = СоответствиеИзмерений;
	ПараметрыПостроения = ЗарплатаКадрыПериодическиеРегистры.ПараметрыПостроенияДляСоздатьВТИмяРегистра();

	ПараметрыПостроения.ИндексироватьПо = Новый Массив;



	ПараметрыПостроения.ВключатьЗаписиНаНачалоПериода = Истина;
	ПараметрыПостроения.ОтборыЗаписейНаНачалоПериода = Новый Массив();
	ЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраПериоды(
		"КадроваяИсторияСотрудников",
		Запрос.МенеджерВременныхТаблиц,
		Ложь,
		ОписаниеВТФильтр,
		ПараметрыПостроения,
		"ВТКадроваяИсторияСотрудниковИнтервалы");

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ДанныеСотрудников.Сотрудник КАК Сотрудник,
	|	ДанныеСотрудников.ТабельныйНомер КАК ТабельныйНомер,
	|	ДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
	|	ДанныеСотрудников.ФОТ КАК ФОТ,
	|	ДанныеСотрудников.Надбавка КАК Надбавка,
	|	ДанныеУчетаВремениСотрудников.ВидУчетаВремени КАК ВидУчетаВремени,
	|	СУММА(ДанныеУчетаВремениСотрудников.Дни) КАК Дни,
	|	СУММА(ДанныеУчетаВремениСотрудников.Часы) КАК Часы,
	|	СУММА(ДанныеУчетаВремениСотрудников.НормаЧасов) КАК НормаЧасов,
	|	КадроваяИсторияСотрудниковИнтервалы.Подразделение КАК Подразделение,
	|	КадроваяИсторияСотрудниковИнтервалы.Должность КАК Должность,
	|	КадроваяИсторияСотрудниковИнтервалы.ДолжностьПоШтатномуРасписанию КАК ДолжностьПоШтатномуРасписанию
	|ИЗ
	|	ВТДанныеСотрудников КАК ДанныеСотрудников
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеУчетаВремениСотрудников КАК ДанныеУчетаВремениСотрудников
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТКадроваяИсторияСотрудниковИнтервалы КАК КадроваяИсторияСотрудниковИнтервалы
	|			ПО ДанныеУчетаВремениСотрудников.Сотрудник = КадроваяИсторияСотрудниковИнтервалы.Сотрудник
	|				И (ДанныеУчетаВремениСотрудников.Дата МЕЖДУ КадроваяИсторияСотрудниковИнтервалы.НачалоПериода И КадроваяИсторияСотрудниковИнтервалы.КонецПериода)
	|		ПО ДанныеСотрудников.Сотрудник = ДанныеУчетаВремениСотрудников.Сотрудник
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеСотрудников.Сотрудник,
	|	ДанныеСотрудников.ТабельныйНомер,
	|	ДанныеСотрудников.ТарифнаяСтавка,
	|	ДанныеСотрудников.ФОТ,
	|	ДанныеСотрудников.Надбавка,
	|	ДанныеУчетаВремениСотрудников.ВидУчетаВремени,
	|	КадроваяИсторияСотрудниковИнтервалы.Подразделение,
	|	КадроваяИсторияСотрудниковИнтервалы.Должность,
	|	КадроваяИсторияСотрудниковИнтервалы.ДолжностьПоШтатномуРасписанию";
	Возврат Запрос.Выполнить();
КонецФункции
