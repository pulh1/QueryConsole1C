Функция ПолучитьДанные(ДатаНачала, Подразделение, ДатаОкончания)
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц();
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("Подразделение", Подразделение);
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	&ДатаНачала КАК ДатаНачала,
	|	&ДатаОкончания КАК ДатаОкончания
	|ПОМЕСТИТЬ ВТФильтрКадроваяИсторияСотрудниковЗаписи";
	Запрос.Выполнить();
	Измерения = Новый Массив();
	СоответствиеИзмерений = Новый Соответствие();
	Измерения.Добавить("ДатаОкончания");
	СоответствиеИзмерений.Вставить("ДатаОкончания", "ДатаОкончания");
	Измерения.Добавить("ДатаНачала");
	СоответствиеИзмерений.Вставить("ДатаНачала", "ДатаНачала");
	ОписаниеВТФильтр = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистраПоВременнойТаблице(
		"ВТФильтрКадроваяИсторияСотрудниковЗаписи",
		Измерения);
	ОписаниеВТФильтр.СоответствиеИзмеренийРегистраИзмерениямФильтра = СоответствиеИзмерений;
	ПараметрыПостроения = ЗарплатаКадрыПериодическиеРегистры.ПараметрыПостроенияДляСоздатьВТИмяРегистра();

	ПараметрыПостроения.ИндексироватьПо = Новый Массив;


	ПараметрыПостроения.ФормироватьСПериодичностьДень = Ложь;
	ПараметрыПостроения.ВключатьЗаписиНаНачалоПериода = Ложь;
	ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.Отборы, "Подразделение", "В", Подразделение);


	ЗапросЗаписи = ЗарплатаКадрыПериодическиеРегистры.ЗапросВТИмяРегистра(
	"КадроваяИсторияСотрудников",
		Ложь,
		ОписаниеВТФильтр,
		ПараметрыПостроения,
		"");
	ЗапросЗаписи.МенеджерВременныхТаблиц = Запрос.МенеджерВременныхТаблиц;
	Возврат ЗапросЗаписи.Выполнить();

КонецФункции
