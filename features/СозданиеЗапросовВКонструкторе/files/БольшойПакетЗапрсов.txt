ВЫБРАТЬ
	Сотрудники.Сотрудник КАК Сотрудник,
	&ДатаОтчета КАК Период
ПОМЕСТИТЬ ВТСотрудникДляСрезаФИО
ИЗ
	ВТСотрудники КАК Сотрудники
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	ТаблицаОтборов.Период КАК Период,
	ТаблицаОтборов.Сотрудник КАК Сотрудник,
	СправочникСотрудники.ФизическоеЛицо КАК ФизическоеЛицо
ПОМЕСТИТЬ ВТОтборовРазличныхПостоянныхСотрудников
ИЗ
	ВТСотрудникДляСрезаФИО КАК ТаблицаОтборов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Сотрудники КАК СправочникСотрудники
		ПО ТаблицаОтборов.Сотрудник = СправочникСотрудники.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	МАКСИМУМ(РегистрСведений.Период) КАК Период,
	ИзмеренияДаты.Период КАК ЗаданныйПериод,
	РегистрСведений.ФизическоеЛицо КАК ФизическоеЛицо
ПОМЕСТИТЬ ВТПериодыСрезаФИОФизическихЛиц
ИЗ
	ВТОтборовРазличныхПостоянныхСотрудников КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизическихЛиц КАК РегистрСведений
		ПО (РегистрСведений.Период <= ВЫБОР
				КОГДА ИзмеренияДаты.Период = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ ИзмеренияДаты.Период
			КОНЕЦ)
			И (РегистрСведений.ФизическоеЛицо = ИзмеренияДаты.ФизическоеЛицо)

СГРУППИРОВАТЬ ПО
	ИзмеренияДаты.Период,
	РегистрСведений.ФизическоеЛицо
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	МаксимальныеПериоды.ЗаданныйПериод КАК Период,
	МаксимальныеПериоды.ФизическоеЛицо КАК ФизическоеЛицо,
	РегистрСведений.Фамилия КАК Фамилия,
	РегистрСведений.Имя КАК Имя,
	РегистрСведений.Отчество КАК Отчество
ПОМЕСТИТЬ ВТСведенияОФИОФизическихЛиц
ИЗ
	ВТПериодыСрезаФИОФизическихЛиц КАК МаксимальныеПериоды
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизическихЛиц КАК РегистрСведений
		ПО (РегистрСведений.Период = МаксимальныеПериоды.Период)
			И МаксимальныеПериоды.ФизическоеЛицо = РегистрСведений.ФизическоеЛицо

ИНДЕКСИРОВАТЬ ПО
	ФизическоеЛицо
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТПериодыСрезаФИОФизическихЛиц
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ТаблицаОтборов.Сотрудник КАК Сотрудник,
	ВЫБОР
		КОГДА СведенияОФИОФизическихЛиц.Фамилия ЕСТЬ NULL
			ТОГДА СправочникФизическиеЛица.ФИО
		ИНАЧЕ СведенияОФИОФизическихЛиц.Фамилия + ВЫБОР
				КОГДА СведенияОФИОФизическихЛиц.Имя = ""
					ТОГДА ""
				ИНАЧЕ " " + СведенияОФИОФизическихЛиц.Имя
			КОНЕЦ + ВЫБОР
				КОГДА СведенияОФИОФизическихЛиц.Отчество = ""
					ТОГДА ""
				ИНАЧЕ " " + СведенияОФИОФизическихЛиц.Отчество
			КОНЕЦ
	КОНЕЦ КАК ФИОПОЛНЫЕ,
	ЕСТЬNULL(СведенияОФИОФизическихЛиц.Фамилия, СправочникФизическиеЛица.Фамилия) + " " КАК ФАМИЛИЯИО
ПОМЕСТИТЬ ПредставленияКадровыеДанныеСотрудников
ИЗ
	ВТОтборовРазличныхПостоянныхСотрудников КАК ТаблицаОтборов
		ЛЕВОЕ СОЕДИНЕНИЕ ВТСведенияОФИОФизическихЛиц КАК СведенияОФИОФизическихЛиц
		ПО ТаблицаОтборов.ФизическоеЛицо = СведенияОФИОФизическихЛиц.ФизическоеЛицо
			И ТаблицаОтборов.Период = СведенияОФИОФизическихЛиц.Период
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица КАК СправочникФизическиеЛица
		ПО ТаблицаОтборов.ФизическоеЛицо = СправочникФизическиеЛица.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТОтборовРазличныхПостоянныхСотрудников
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТСведенияОФИОФизическихЛиц
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПериодыРаботы.Сотрудник КАК Сотрудник,
	ВЫБОР
		КОГДА ПериодыРаботы.Начало < Сотрудники.ДатаНачала
			ТОГДА Сотрудники.ДатаНачала
		ИНАЧЕ ПериодыРаботы.Начало
	КОНЕЦ КАК ДатаНачала,
	ВЫБОР
		КОГДА ПериодыРаботы.Окончание > Сотрудники.ДатаОкончания
				ИЛИ ПериодыРаботы.Окончание = ДАТАВРЕМЯ(1, 1, 1)
			ТОГДА Сотрудники.ДатаОкончания
		ИНАЧЕ ПериодыРаботы.Окончание
	КОНЕЦ КАК ДатаОкончания,
	ПериодыРаботы.Филиал КАК Организация,
	ПериодыРаботы.Подразделение КАК Подразделение,
	ПериодыРаботы.ДолжностьПоШтатномуРасписанию.Должность КАК Должность
ПОМЕСТИТЬ ВТПериодыРаботыСотрудников
ИЗ
	ВТСотрудники КАК Сотрудники
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ДанныеДляПодбораСотрудников КАК ПериодыРаботы
		ПО Сотрудники.Сотрудник = ПериодыРаботы.Сотрудник
			И (Сотрудники.ДатаНачала >= ПериодыРаботы.Начало
					И (Сотрудники.ДатаНачала <= ПериодыРаботы.Окончание
						ИЛИ ПериодыРаботы.Окончание = ДАТАВРЕМЯ(1, 1, 1))
				ИЛИ ПериодыРаботы.Начало МЕЖДУ Сотрудники.ДатаНачала И Сотрудники.ДатаОкончания)
ГДЕ
	ПериодыРаботы.ВидСобытия <> ЗНАЧЕНИЕ(Перечисление.ВидыКадровыхСобытий.Увольнение)
	И НЕ ПериодыРаботы.ПоДоговоруГПХ
	И ИСТИНА
	И ИСТИНА
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	0 КАК Цифра
ПОМЕСТИТЬ ВТЦифры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	2

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	3

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	4

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	5

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	6

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	7

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	8

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	9
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВЫБОР
					КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
					ИНАЧЕ &МесяцДатаНачала
				КОНЕЦ, МЕСЯЦ), МЕСЯЦ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), МЕСЯЦ) КАК Месяц
ПОМЕСТИТЬ ВТМесяцы
ИЗ
	ВТЦифры КАК Цифры
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
							ТОГДА &ОкончаниеИнтервалаВТМесяцы
						ИНАЧЕ &МесяцДатаОкончания
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ) > 9)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
							ТОГДА &ОкончаниеИнтервалаВТМесяцы
						ИНАЧЕ &МесяцДатаОкончания
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ) > 99)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры1000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
							ТОГДА &ОкончаниеИнтервалаВТМесяцы
						ИНАЧЕ &МесяцДатаОкончания
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ) > 999)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
							ТОГДА &ОкончаниеИнтервалаВТМесяцы
						ИНАЧЕ &МесяцДатаОкончания
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ) > 9999)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
							ТОГДА &ОкончаниеИнтервалаВТМесяцы
						ИНАЧЕ &МесяцДатаОкончания
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ) > 99999)
ГДЕ
	НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &МесяцДатаНачала
					КОНЕЦ, МЕСЯЦ), МЕСЯЦ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), МЕСЯЦ) МЕЖДУ ВЫБОР
			КОГДА &МесяцДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
			ИНАЧЕ &МесяцДатаНачала
		КОНЕЦ И ВЫБОР
			КОГДА &МесяцДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ)
				ТОГДА &ОкончаниеИнтервалаВТМесяцы
			ИНАЧЕ &МесяцДатаОкончания
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТЦифры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПериодыРаботыСотрудников.Сотрудник КАК Сотрудник,
	ПериодыРаботыСотрудников.Сотрудник.ГоловнойСотрудник КАК ГоловнойСотрудник,
	Месяцы.Месяц КАК Месяц,
	ВЫБОР
		КОГДА &ДатаНачала > Месяцы.Месяц
			ТОГДА &ДатаНачала
		ИНАЧЕ Месяцы.Месяц
	КОНЕЦ КАК ДатаНачала,
	ВЫБОР
		КОГДА &ДатаОкончания < КОНЕЦПЕРИОДА(Месяцы.Месяц, МЕСЯЦ)
			ТОГДА &ДатаОкончания
		ИНАЧЕ КОНЕЦПЕРИОДА(Месяцы.Месяц, МЕСЯЦ)
	КОНЕЦ КАК ДатаОкончания,
	&ДатаОтчета КАК ДатаАктуальности
ПОМЕСТИТЬ ВТСотрудникиМесяцы
ИЗ
	ВТМесяцы КАК Месяцы
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПериодыРаботыСотрудников КАК ПериодыРаботыСотрудников
		ПО (ИСТИНА)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВЫБОР
		КОГДА РегистрСведений.ДатаНачала <= НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
			ТОГДА НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
		ИНАЧЕ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ)
	КОНЕЦ КАК НачалоПериода,
	ВЫБОР
		КОГДА КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ) > ВЫБОР
				КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
			КОНЕЦ
			ТОГДА ВЫБОР
					КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
					ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
				КОНЕЦ
		ИНАЧЕ КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ)
	КОНЕЦ КАК КонецПериода,
	РегистрСведений.Сотрудник КАК Сотрудник,
	РегистрСведений.ГрафикРаботы КАК ГрафикРаботы
ПОМЕСТИТЬ ВТПериодыДействияГрафиковДляКалендарей
ИЗ
	ВТПериодыРаботыСотрудников КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикРаботыСотрудниковИнтервальный КАК РегистрСведений
		ПО (РегистрСведений.ДатаНачала >= ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ), ДЕНЬ, 1)
					И РегистрСведений.ДатаНачала <= ВЫБОР
						КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
						ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
					КОНЕЦ
				ИЛИ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ) <= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
					И РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускОсновной) КАК Состояние,
	&ОсновнойОтпуск КАК ВидВремени
ПОМЕСТИТЬ ВТСоответствиеСостоянийВидамУчетаВремени

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ДополнительныйОтпуск),
	&ДополнительныйОтпуск

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ДополнительныйОтпускНеоплачиваемый),
	&НеоплачиваемыйДополнительныйОтпуск

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускУчебныйОплачиваемый),
	&ОтпускНаОбучение

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускУчебныйНеоплачиваемый),
	&ОтпускНаОбучениеНеоплачиваемый

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускНеоплачиваемыйПоРазрешениюРаботодателя),
	&НеоплачиваемыйОтпускПоРазрешениюРаботодателя

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускНеоплачиваемыйПоЗаконодательству),
	&НеоплачиваемыйОтпускПоЗаконодательству

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускПоУходуЗаРебенком),
	&ОтпускПоУходуЗаРебенком

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Командировка),
	&Командировка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ВыполнениеГосударственныхОбязанностей),
	&ГосударственныеОбязанности

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтсутствиеССохранениемОплаты),
	&ГосударственныеОбязанности

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ДополнительныеВыходныеДниОплачиваемые),
	&ДополнительныеВыходныеДниОплачиваемые

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ВынужденныйПрогул),
	&ВынужденныйПрогул

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтсутствиеПоНевыясненнымПричинам),
	&НеявкиПоНевыясненнымПричинам

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускПоБеременностиИРодам),
	&ОтпускПоБеременностиИРодам

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Болезнь),
	&Болезнь

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.БолезньБезОплаты),
	&БолезньБезОплаты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Прогул),
	&Прогулы

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ПростойНеЗависящийОтРаботодателяИРаботника),
	&Простой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ПростойПоВинеРаботника),
	&ПростойПоВинеРаботника

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ДополнительныеВыходныеДниНеОплачиваемые),
	&ДополнительныеВыходныеДниНеОплачиваемые

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ПростойПоВинеРаботодателя),
	&ПростойПоВинеРаботодателя

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускНаСанаторноКурортноеЛечение),
	&ДополнительныйОтпуск

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ТрудовойДоговорПриостановлен),
	&ПриостановлениеТрудовогоДоговора
;    
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВЫБОР
					КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
					ИНАЧЕ &ДатаНачала
				КОНЕЦ, ДЕНЬ), ДЕНЬ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), ДЕНЬ) КАК Дата
ПОМЕСТИТЬ ВТДатыСостояний
ИЗ
	ВТЦифры КАК Цифры
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
							ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
						ИНАЧЕ &ДатаОкончания
					КОНЕЦ, ДЕНЬ), ДЕНЬ) > 9)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
							ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
						ИНАЧЕ &ДатаОкончания
					КОНЕЦ, ДЕНЬ), ДЕНЬ) > 99)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры1000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
							ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
						ИНАЧЕ &ДатаОкончания
					КОНЕЦ, ДЕНЬ), ДЕНЬ) > 999)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
							ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
						ИНАЧЕ &ДатаОкончания
					КОНЕЦ, ДЕНЬ), ДЕНЬ) > 9999)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100000
		ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
							ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
						ИНАЧЕ &ДатаОкончания
					КОНЕЦ, ДЕНЬ), ДЕНЬ) > 99999)
ГДЕ
	НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВЫБОР
						КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
						ИНАЧЕ &ДатаНачала
					КОНЕЦ, ДЕНЬ), ДЕНЬ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), ДЕНЬ) МЕЖДУ ВЫБОР
			КОГДА &ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА ДАТАВРЕМЯ(1980, 1, 1)
			ИНАЧЕ &ДатаНачала
		КОНЕЦ И ВЫБОР
			КОГДА &ДатаОкончания = КОНЕЦПЕРИОДА(ДАТАВРЕМЯ(1, 1, 1), ДЕНЬ)
				ТОГДА &ОкончаниеИнтервалаВТДатыСостояний
			ИНАЧЕ &ДатаОкончания
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТЦифры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Сотрудники.Сотрудник КАК Сотрудник,
	Сотрудники.Месяц КАК Месяц,
	Сотрудники.ДатаНачала КАК ДатаНачала,
	Сотрудники.ДатаОкончания КАК ДатаОкончания,
	Сотрудники.ДатаАктуальности КАК ДатаАктуальности,
	МАКСИМУМ(ЕСТЬNULL(ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации, ДАТАВРЕМЯ(1, 1, 1))) КАК ПериодРегистрации
ПОМЕСТИТЬ ВТПараметрыЗарегистрированныхДанныхУчетаВремени
ИЗ
	ВТСотрудникиМесяцы КАК Сотрудники
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыЗарегистрированныхДанныхУчетаВремениСотрудников КАК ПараметрыЗарегистрированныхДанныхУчетаВремени
		ПО Сотрудники.Сотрудник = ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник
			И Сотрудники.Месяц = ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц
			И Сотрудники.ДатаАктуальности >= ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации
			И (ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаНачала, МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаОкончания, МЕСЯЦ))
			И (ИСТИНА)
ГДЕ
	(ЕСТЬNULL(ПараметрыЗарегистрированныхДанныхУчетаВремени.ПорядокФормированияИндивидуальныхСведений, ЗНАЧЕНИЕ(Перечисление.ПорядокФормированияИндивидуальныхСведенийУчетаВремени.НеФормировать)) <> ЗНАЧЕНИЕ(Перечисление.ПорядокФормированияИндивидуальныхСведенийУчетаВремени.НеФормировать)
			ИЛИ НЕ &УчитыватьТолькоИндивидуальныеСведения)

СГРУППИРОВАТЬ ПО
	Сотрудники.Сотрудник,
	Сотрудники.Месяц,
	Сотрудники.ДатаАктуальности,
	Сотрудники.ДатаНачала,
	Сотрудники.ДатаОкончания
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник КАК Сотрудник,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц КАК Месяц,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаНачала КАК ДатаНачала,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаОкончания КАК ДатаОкончания,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации КАК ПериодРегистрации
ПОМЕСТИТЬ ВТСотрудникСРассчитаннымиДанными
ИЗ
	ВТПараметрыЗарегистрированныхДанныхУчетаВремени КАК ПараметрыЗарегистрированныхДанныхУчетаВремени
ГДЕ
	&ИспользоватьУжеРассчитанныеДанные
	И НЕ &ОтноситьПереходящуюЧастьСменыКДнюНачала
	И 1 В
			(ВЫБРАТЬ ПЕРВЫЕ 1
				1 КАК Флаг
			ИЗ
				РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			ГДЕ
				ГрафикиРаботыПоВидамВремени.ГрафикРаботы = ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник
				И ГрафикиРаботыПоВидамВремени.Месяц = ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц
				И ГрафикиРаботыПоВидамВремени.ПериодРегистрации = ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник КАК Сотрудник,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц КАК Месяц,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаНачала КАК ДатаНачала,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаОкончания КАК ДатаОкончания,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
	ВЫБОР
		КОГДА &ИспользоватьУжеРассчитанныеДанные
				И &ПолучатьДанныеФакт
				И НЕ СотрудникСРассчитаннымиДанными.Сотрудник ЕСТЬ NULL
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ПолучатьРассчитанныеДанныеФакт,
	ВЫБОР
		КОГДА &ИспользоватьУжеРассчитанныеДанные
				И &ПолучатьДанныеФакт
				И НЕ СотрудникСРассчитаннымиДанными.Сотрудник ЕСТЬ NULL
			ТОГДА ЛОЖЬ
		ИНАЧЕ &ПолучатьДанныеФакт
	КОНЕЦ КАК ВыполнятьРасчетИсточниковДанныхФакт,
	ВЫБОР
		КОГДА &РассчитыватьПлановоеВремя
			ТОГДА ИСТИНА
		КОГДА &ИспользоватьУжеРассчитанныеДанные
				И &ПолучатьДанныеНорма
				И НЕ СотрудникСРассчитаннымиДанными.Сотрудник ЕСТЬ NULL
			ТОГДА ЛОЖЬ
		ИНАЧЕ &ПолучатьДанныеНорма
	КОНЕЦ КАК ВыполнятьРасчетИсточниковДанныхПлан
ПОМЕСТИТЬ ВТПараметрыПолученияДанныхПоСотрудникам
ИЗ
	ВТПараметрыЗарегистрированныхДанныхУчетаВремени КАК ПараметрыЗарегистрированныхДанныхУчетаВремени
		ЛЕВОЕ СОЕДИНЕНИЕ ВТСотрудникСРассчитаннымиДанными КАК СотрудникСРассчитаннымиДанными
		ПО ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник = СотрудникСРассчитаннымиДанными.Сотрудник
			И ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц = СотрудникСРассчитаннымиДанными.Месяц
			И ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаАктуальности = СотрудникСРассчитаннымиДанными.ДатаАктуальности
			И ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации = СотрудникСРассчитаннымиДанными.ПериодРегистрации
			И ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаНачала = СотрудникСРассчитаннымиДанными.ДатаНачала
			И ПараметрыЗарегистрированныхДанныхУчетаВремени.ДатаОкончания = СотрудникСРассчитаннымиДанными.ДатаОкончания
ГДЕ
	(СотрудникСРассчитаннымиДанными.Сотрудник ЕСТЬ NULL
			ИЛИ &РассчитыватьПлановоеВремя
			ИЛИ &ФормироватьПриНаличииРассчитанныхДанных)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПараметрыПолученияДанныхПоСотрудникам.Сотрудник КАК Сотрудник,
	ПараметрыПолученияДанныхПоСотрудникам.Месяц КАК Месяц,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаНачала КАК ДатаНачала,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаОкончания КАК ДатаОкончания,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаАктуальности КАК ДатаАктуальности,
	ПараметрыПолученияДанныхПоСотрудникам.ПериодРегистрации КАК ПериодРегистрации,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхФакт КАК ВыполнятьРасчетИсточниковДанныхФакт,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхПлан КАК ВыполнятьРасчетИсточниковДанныхПлан,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ВидДанных КАК ВидДанных,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень1) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень1,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень2) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень2,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень3) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень3,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень4) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень4,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень5) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень5,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень6) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень6,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень7) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень7,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень8) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень8,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень9) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень9,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень10) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень10,
	ВЫБОР
		КОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень11) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленДень11,
	ВЫБОР
		КОГДА НЕ &ОтноситьПереходящуюЧастьСменыКДнюНачала
				И СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК УстановленаПереходящаяЧастьСменыПредыдущегоМесяца,
	ПараметрыПолученияДанныхПоСотрудникам.ПолучатьРассчитанныеДанныеФакт КАК ПолучатьРассчитанныеДанныеФакт
ПОМЕСТИТЬ ВТЗарегистрированныеВидыДанныхУчетаВремени
ИЗ
	ВТПараметрыПолученияДанныхПоСотрудникам КАК ПараметрыПолученияДанныхПоСотрудникам
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыЗарегистрированныхДанныхУчетаВремениСотрудников КАК ПараметрыЗарегистрированныхДанныхУчетаВремени
		ПО ПараметрыПолученияДанныхПоСотрудникам.Сотрудник = ПараметрыЗарегистрированныхДанныхУчетаВремени.Сотрудник
			И ПараметрыПолученияДанныхПоСотрудникам.Месяц = ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц
			И ПараметрыПолученияДанныхПоСотрудникам.ДатаАктуальности >= ПараметрыЗарегистрированныхДанныхУчетаВремени.ПериодРегистрации
			И (ПараметрыЗарегистрированныхДанныхУчетаВремени.ВидДанных <> ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков))
			И (ПараметрыЗарегистрированныхДанныхУчетаВремени.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаНачала, МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаОкончания, МЕСЯЦ))
			И (ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхФакт
				ИЛИ ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхПлан
					И ПараметрыЗарегистрированныхДанныхУчетаВремени.ВидДанных В (&ВидыДанныхПлановогоВремени))
			И (ИСТИНА)

СГРУППИРОВАТЬ ПО
	ПараметрыПолученияДанныхПоСотрудникам.Сотрудник,
	ПараметрыПолученияДанныхПоСотрудникам.Месяц,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаНачала,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаОкончания,
	ПараметрыЗарегистрированныхДанныхУчетаВремени.ВидДанных,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаАктуальности,
	ПараметрыПолученияДанныхПоСотрудникам.ПериодРегистрации,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхФакт,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхПлан,
	ПараметрыПолученияДанныхПоСотрудникам.ПолучатьРассчитанныеДанныеФакт

ИМЕЮЩИЕ
	СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень1) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень2) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень3) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень4) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень5) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень6) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень7) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень8) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень9) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень10) + СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленДень11)  + ВЫБОР
		КОГДА НЕ &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА СУММА(ПараметрыЗарегистрированныхДанныхУчетаВремени.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца)
		ИНАЧЕ 0
	КОНЕЦ > 0

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПараметрыПолученияДанныхПоСотрудникам.Сотрудник,
	ПараметрыПолученияДанныхПоСотрудникам.Месяц,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаНачала,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаОкончания,
	ПараметрыПолученияДанныхПоСотрудникам.ДатаАктуальности,
	ПараметрыПолученияДанныхПоСотрудникам.ПериодРегистрации,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхФакт,
	ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхПлан,
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	1,
	ПараметрыПолученияДанныхПоСотрудникам.ПолучатьРассчитанныеДанныеФакт
ИЗ
	ВТПараметрыПолученияДанныхПоСотрудникам КАК ПараметрыПолученияДанныхПоСотрудникам
ГДЕ
	(ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхФакт
			ИЛИ ПараметрыПолученияДанныхПоСотрудникам.ВыполнятьРасчетИсточниковДанныхПлан)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков) КАК ВидДанных,
	ИСТИНА КАК Факт
ПОМЕСТИТЬ ВТИспользуемыеВидыДанных

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеВнутрисменныхНеявок),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ВытесняемоеПлановоеВремя),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДополнительноеВнутрисменноеВремя),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	ЛОЖЬ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ЛОЖЬ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков) КАК ВидДанных,
	ЗНАЧЕНИЕ(перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков) КАК ВидДанныхВытесняющий,
	ИСТИНА КАК Факт
ПОМЕСТИТЬ ВТВытесняющиеВидыДанных

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ВытесняемоеПлановоеВремя),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ВытесняемоеПлановоеВремя),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ВытесняемоеПлановоеВремя),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеВнутрисменныхНеявок),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДополнительноеВнутрисменноеВремя),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОперативногоУчета),
	ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков),
	ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков),
	ЛОЖЬ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	1 КАК НомерДня,
	ЛОЖЬ КАК ПереходящаяЧастьСмены,
	1 КАК УстановленДень1,
	0 КАК УстановленДень2,
	0 КАК УстановленДень3,
	0 КАК УстановленДень4,
	0 КАК УстановленДень5,
	0 КАК УстановленДень6,
	0 КАК УстановленДень7,
	0 КАК УстановленДень8,
	0 КАК УстановленДень9,
	0 КАК УстановленДень10,
	0 КАК УстановленДень11
ПОМЕСТИТЬ ВТВспомогательнаяТаблицаОпределенияУстановленныхДнейПериода

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	2,
	ЛОЖЬ,
	0,
	1,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВЫБОР
		КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА 31
		ИНАЧЕ 31 + 1
	КОНЕЦ,
	ИСТИНА,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИспользуемыеИсточникиДанныхНесгруппированные.Сотрудник КАК Сотрудник,
	ИспользуемыеИсточникиДанныхНесгруппированные.Месяц КАК Месяц,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаНачала КАК ДатаНачала,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаОкончания КАК ДатаОкончания,
	ИспользуемыеИсточникиДанныхНесгруппированные.ВидДанных КАК ВидДанных,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаАктуальности КАК ДатаАктуальности,
	ИспользуемыеИсточникиДанныхНесгруппированные.ПериодРегистрации КАК ПериодРегистрации,
	МАКСИМУМ(ВЫБОР
			КОГДА ИспользуемыеИсточникиДанныхНесгруппированные.Факт
				ТОГДА ИспользуемыеИсточникиДанныхНесгруппированные.Вытеснен
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК ВыполнятьФильтрациюДанныхФакт,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ИспользуемыеИсточникиДанныхНесгруппированные.Факт
				ТОГДА ИспользуемыеИсточникиДанныхНесгруппированные.Вытеснен
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК ВыполнятьФильтрациюДанныхПлан,
	МАКСИМУМ(ВЫБОР
			КОГДА ИспользуемыеИсточникиДанныхНесгруппированные.Факт
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК ИспользоватьДанныеИсточникаФакт,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ИспользуемыеИсточникиДанныхНесгруппированные.Факт
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК ИспользоватьДанныеИсточникаПлан,
	МАКСИМУМ(ИспользуемыеИсточникиДанныхНесгруппированные.Вытеснен) КАК ВыполнятьФильтрациюДанных,
	МАКСИМУМ(ИспользуемыеИсточникиДанныхНесгруппированные.ПолучатьРассчитанныеДанныеФакт) КАК ПолучатьРассчитанныеДанныеФакт,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень1) КАК УстановленДень1,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень2) КАК УстановленДень2,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень3) КАК УстановленДень3,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень4) КАК УстановленДень4,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень5) КАК УстановленДень5,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень6) КАК УстановленДень6,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень7) КАК УстановленДень7,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень8) КАК УстановленДень8,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень9) КАК УстановленДень9,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень10) КАК УстановленДень10,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень11) КАК УстановленДень11,
	СУММА(ИспользуемыеИсточникиДанныхНесгруппированные.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца) КАК УстановленаПереходящаяЧастьСменыПредыдущегоМесяца
ПОМЕСТИТЬ ВТИспользуемыеИсточникиДанныхНеотфильтрованные
ИЗ
	(ВЫБРАТЬ
		ИспользуемыеВидыДанныхУчетомВытеснения.Сотрудник КАК Сотрудник,
		ИспользуемыеВидыДанныхУчетомВытеснения.Месяц КАК Месяц,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаНачала КАК ДатаНачала,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаОкончания КАК ДатаОкончания,
		ИспользуемыеВидыДанныхУчетомВытеснения.Факт КАК Факт,
		ИспользуемыеВидыДанныхУчетомВытеснения.ВидДанных КАК ВидДанных,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаАктуальности КАК ДатаАктуальности,
		ИспользуемыеВидыДанныхУчетомВытеснения.ПериодРегистрации КАК ПериодРегистрации,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень1) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень1,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень2) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень2,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень3) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень3,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень4) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень4,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень5) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень5,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень6) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень6,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень7) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень7,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень8) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень8,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень9) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень9,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень10) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень10,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленДень11) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленДень11,
		МИНИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца) * ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК УстановленаПереходящаяЧастьСменыПредыдущегоМесяца,
		МАКСИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.Вытеснен) КАК Вытеснен,
		МАКСИМУМ(ИспользуемыеВидыДанныхУчетомВытеснения.ПолучатьРассчитанныеДанныеФакт) КАК ПолучатьРассчитанныеДанныеФакт,
		ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт КАК МножительПризнакФакт
	ИЗ
		(ВЫБРАТЬ
			ЗарегистрированныеВидыДанныхУчетаВремени.Сотрудник КАК Сотрудник,
			ЗарегистрированныеВидыДанныхУчетаВремени.Месяц КАК Месяц,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаНачала КАК ДатаНачала,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаОкончания КАК ДатаОкончания,
			ИспользуемыеВидыДанных.Факт КАК Факт,
			ВЫБОР
				КОГДА ИспользуемыеВидыДанных.Факт
					ТОГДА 2
				ИНАЧЕ 1
			КОНЕЦ КАК МножительПризнакФакт,
			ЗарегистрированныеВидыДанныхУчетаВремени.ВидДанных КАК ВидДанных,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
			ЗарегистрированныеВидыДанныхУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень1 КАК УстановленДень1,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень2 КАК УстановленДень2,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень3 КАК УстановленДень3,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень4 КАК УстановленДень4,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень5 КАК УстановленДень5,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень6 КАК УстановленДень6,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень7 КАК УстановленДень7,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень8 КАК УстановленДень8,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень9 КАК УстановленДень9,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень10 КАК УстановленДень10,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень11 КАК УстановленДень11,
			ЗарегистрированныеВидыДанныхУчетаВремени.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца КАК УстановленаПереходящаяЧастьСменыПредыдущегоМесяца,
			1 КАК ДанныеЗарегистрированы,
			ЛОЖЬ КАК Вытеснен,
			ЗарегистрированныеВидыДанныхУчетаВремени.ПолучатьРассчитанныеДанныеФакт КАК ПолучатьРассчитанныеДанныеФакт
		ИЗ
			ВТЗарегистрированныеВидыДанныхУчетаВремени КАК ЗарегистрированныеВидыДанныхУчетаВремени
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТИспользуемыеВидыДанных КАК ИспользуемыеВидыДанных
				ПО ЗарегистрированныеВидыДанныхУчетаВремени.ВидДанных = ИспользуемыеВидыДанных.ВидДанных
					И (ИспользуемыеВидыДанных.Факт
							И ЗарегистрированныеВидыДанныхУчетаВремени.ВыполнятьРасчетИсточниковДанныхФакт
						ИЛИ НЕ ИспользуемыеВидыДанных.Факт
							И ЗарегистрированныеВидыДанныхУчетаВремени.ВыполнятьРасчетИсточниковДанныхПлан)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ЗарегистрированныеВидыДанныхУчетаВремени.Сотрудник,
			ЗарегистрированныеВидыДанныхУчетаВремени.Месяц,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаНачала,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаОкончания,
			ВытесняющиеВидыДанных.Факт,
			ВЫБОР
				КОГДА ВытесняющиеВидыДанных.Факт
					ТОГДА 2
				ИНАЧЕ 1
			КОНЕЦ,
			ВытесняющиеВидыДанных.ВидДанных,
			ЗарегистрированныеВидыДанныхУчетаВремени.ДатаАктуальности,
			ЗарегистрированныеВидыДанныхУчетаВремени.ПериодРегистрации,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень1,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень2,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень3,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень4,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень5,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень6,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень7,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень8,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень9,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень10,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленДень11,
			1 - ЗарегистрированныеВидыДанныхУчетаВремени.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца,
			0,
			ВытесняющиеВидыДанных.ВидДанных <> ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные),
			ЗарегистрированныеВидыДанныхУчетаВремени.ПолучатьРассчитанныеДанныеФакт
		ИЗ
			ВТЗарегистрированныеВидыДанныхУчетаВремени КАК ЗарегистрированныеВидыДанныхУчетаВремени
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВытесняющиеВидыДанных КАК ВытесняющиеВидыДанных
				ПО ЗарегистрированныеВидыДанныхУчетаВремени.ВидДанных = ВытесняющиеВидыДанных.ВидДанныхВытесняющий
					И (ВытесняющиеВидыДанных.Факт
							И ЗарегистрированныеВидыДанныхУчетаВремени.ВыполнятьРасчетИсточниковДанныхФакт
						ИЛИ НЕ ВытесняющиеВидыДанных.Факт
							И ЗарегистрированныеВидыДанныхУчетаВремени.ВыполнятьРасчетИсточниковДанныхПлан)) КАК ИспользуемыеВидыДанныхУчетомВытеснения
	
	СГРУППИРОВАТЬ ПО
		ИспользуемыеВидыДанныхУчетомВытеснения.Сотрудник,
		ИспользуемыеВидыДанныхУчетомВытеснения.Месяц,
		ИспользуемыеВидыДанныхУчетомВытеснения.ВидДанных,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаАктуальности,
		ИспользуемыеВидыДанныхУчетомВытеснения.ПериодРегистрации,
		ИспользуемыеВидыДанныхУчетомВытеснения.Факт,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаНачала,
		ИспользуемыеВидыДанныхУчетомВытеснения.ДатаОкончания,
		ИспользуемыеВидыДанныхУчетомВытеснения.МножительПризнакФакт
	
	ИМЕЮЩИЕ
		СУММА(ИспользуемыеВидыДанныхУчетомВытеснения.ДанныеЗарегистрированы) > 0) КАК ИспользуемыеИсточникиДанныхНесгруппированные
ГДЕ
	ВЫБОР
			КОГДА ИспользуемыеИсточникиДанныхНесгруппированные.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные)
				ТОГДА ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень1 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень2 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень3 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень4 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень5 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень6 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень7 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень8 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень9 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень10 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень11 * ИспользуемыеИсточникиДанныхНесгруппированные.МножительПризнакФакт > 0
			ИНАЧЕ ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень1 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень2 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень3 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень4 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень5 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень6 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень7 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень8 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень9 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень10 + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленДень11  + ИспользуемыеИсточникиДанныхНесгруппированные.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца > 0
		КОНЕЦ

СГРУППИРОВАТЬ ПО
	ИспользуемыеИсточникиДанныхНесгруппированные.Сотрудник,
	ИспользуемыеИсточникиДанныхНесгруппированные.Месяц,
	ИспользуемыеИсточникиДанныхНесгруппированные.ВидДанных,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаАктуальности,
	ИспользуемыеИсточникиДанныхНесгруппированные.ПериодРегистрации,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаНачала,
	ИспользуемыеИсточникиДанныхНесгруппированные.ДатаОкончания
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИспользуемыеИсточникиДанныхНеотфильтрованные.Сотрудник КАК Сотрудник,
	ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц КАК Месяц,
	ВЫБОР
		КОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные)
				ИЛИ НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
			ТОГДА ИСТИНА
		ИНАЧЕ ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
	КОНЕЦ КАК ПолучатьПереходящуюЧастьСмены,
	ВЫБОР
		КОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные)
				ИЛИ НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
			ТОГДА ИСТИНА
		ИНАЧЕ НЕ ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
	КОНЕЦ КАК ПолучатьОсновнуюЧастьСмены,
	ВЫБОР
		КОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные)
			ТОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
			ТОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаНачала
		КОГДА ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
				И &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ДОБАВИТЬКДАТЕ(ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц, ДЕНЬ, ЕСТЬNULL(ВспомогательнаяТаблицаФильтрации.НомерДня, 1))
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц, ДЕНЬ, ЕСТЬNULL(ВспомогательнаяТаблицаФильтрации.НомерДня, 1) - 1)
	КОНЕЦ КАК ДатаНачала,
	ВЫБОР
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
				И &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ДОБАВИТЬКДАТЕ(ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаОкончания, ДЕНЬ, 1)
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
			ТОГДА ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаОкончания
		КОГДА ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
				И &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ДОБАВИТЬКДАТЕ(ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц, ДЕНЬ, ЕСТЬNULL(ВспомогательнаяТаблицаФильтрации.НомерДня, 1))
		ИНАЧЕ ДОБАВИТЬКДАТЕ(ИспользуемыеИсточникиДанныхНеотфильтрованные.Месяц, ДЕНЬ, ЕСТЬNULL(ВспомогательнаяТаблицаФильтрации.НомерДня, 1) - 1)
	КОНЕЦ КАК ДатаОкончания,
	ИспользуемыеИсточникиДанныхНеотфильтрованные.ВидДанных КАК ВидДанных,
	ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаАктуальности КАК ДатаАктуальности,
	ИспользуемыеИсточникиДанныхНеотфильтрованные.ПериодРегистрации КАК ПериодРегистрации,
	ВЫБОР
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
				И &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ПолучатьПереходящуюЧастьСменыНаНачалоПериода,
	ВЫБОР
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
				И &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ПолучатьОсновнуюЧастьСменыНаКонецПериода,
	ВЫБОР
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
					И ИспользуемыеИсточникиДанныхНеотфильтрованные.ИспользоватьДанныеИсточникаФакт
				ИЛИ НЕ &ОтноситьПереходящуюЧастьСменыКДнюНачала
					И ВспомогательнаяТаблицаФильтрации.НомерДня = 1
					И ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
					И ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца >= 2
				ИЛИ ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень1 * ВспомогательнаяТаблицаФильтрации.УстановленДень1 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень2 * ВспомогательнаяТаблицаФильтрации.УстановленДень2 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень3 * ВспомогательнаяТаблицаФильтрации.УстановленДень3 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень4 * ВспомогательнаяТаблицаФильтрации.УстановленДень4 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень5 * ВспомогательнаяТаблицаФильтрации.УстановленДень5 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень6 * ВспомогательнаяТаблицаФильтрации.УстановленДень6 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень7 * ВспомогательнаяТаблицаФильтрации.УстановленДень7 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень8 * ВспомогательнаяТаблицаФильтрации.УстановленДень8 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень9 * ВспомогательнаяТаблицаФильтрации.УстановленДень9 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень10 * ВспомогательнаяТаблицаФильтрации.УстановленДень10 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень11 * ВспомогательнаяТаблицаФильтрации.УстановленДень11 >= 2
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ПолучатьДанныеФакт,
	ВЫБОР
		КОГДА НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
					И ИспользуемыеИсточникиДанныхНеотфильтрованные.ИспользоватьДанныеИсточникаПлан
				ИЛИ ВспомогательнаяТаблицаФильтрации.НомерДня = 1
					И ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
					И ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца В (1, 3)
				ИЛИ ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень1 * ВспомогательнаяТаблицаФильтрации.УстановленДень1 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень2 * ВспомогательнаяТаблицаФильтрации.УстановленДень2 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень3 * ВспомогательнаяТаблицаФильтрации.УстановленДень3 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень4 * ВспомогательнаяТаблицаФильтрации.УстановленДень4 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень5 * ВспомогательнаяТаблицаФильтрации.УстановленДень5 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень6 * ВспомогательнаяТаблицаФильтрации.УстановленДень6 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень7 * ВспомогательнаяТаблицаФильтрации.УстановленДень7 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень8 * ВспомогательнаяТаблицаФильтрации.УстановленДень8 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень9 * ВспомогательнаяТаблицаФильтрации.УстановленДень9 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень10 * ВспомогательнаяТаблицаФильтрации.УстановленДень10 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень11 * ВспомогательнаяТаблицаФильтрации.УстановленДень11  В (1, 3) 
				ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ПолучатьДанныеПлан,
	ИспользуемыеИсточникиДанныхНеотфильтрованные.ПолучатьРассчитанныеДанныеФакт КАК ПолучатьРассчитанныеДанныеФакт
ПОМЕСТИТЬ ВТИсточникиПолученияДанныхУчетаВремени
ИЗ
	ВТИспользуемыеИсточникиДанныхНеотфильтрованные КАК ИспользуемыеИсточникиДанныхНеотфильтрованные
		ЛЕВОЕ СОЕДИНЕНИЕ ВТВспомогательнаяТаблицаОпределенияУстановленныхДнейПериода КАК ВспомогательнаяТаблицаФильтрации
		ПО (ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных)
			И (ВспомогательнаяТаблицаФильтрации.НомерДня МЕЖДУ ДЕНЬ(ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаНачала) И ДЕНЬ(ИспользуемыеИсточникиДанныхНеотфильтрованные.ДатаОкончания))
ГДЕ
	(НЕ ИспользуемыеИсточникиДанныхНеотфильтрованные.ВыполнятьФильтрациюДанных
			ИЛИ ВспомогательнаяТаблицаФильтрации.НомерДня = 1
				И ВспомогательнаяТаблицаФильтрации.ПереходящаяЧастьСмены
				И ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленаПереходящаяЧастьСменыПредыдущегоМесяца > 0
			ИЛИ ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень1 * ВспомогательнаяТаблицаФильтрации.УстановленДень1 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень2 * ВспомогательнаяТаблицаФильтрации.УстановленДень2 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень3 * ВспомогательнаяТаблицаФильтрации.УстановленДень3 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень4 * ВспомогательнаяТаблицаФильтрации.УстановленДень4 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень5 * ВспомогательнаяТаблицаФильтрации.УстановленДень5 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень6 * ВспомогательнаяТаблицаФильтрации.УстановленДень6 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень7 * ВспомогательнаяТаблицаФильтрации.УстановленДень7 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень8 * ВспомогательнаяТаблицаФильтрации.УстановленДень8 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень9 * ВспомогательнаяТаблицаФильтрации.УстановленДень9 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень10 * ВспомогательнаяТаблицаФильтрации.УстановленДень10 + ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень11 * ИспользуемыеИсточникиДанныхНеотфильтрованные.УстановленДень11  > 0)
;
////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТИспользуемыеВидыДанных
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТВытесняющиеВидыДанных
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТВспомогательнаяТаблицаОпределенияУстановленныхДнейПериода
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТИспользуемыеИсточникиДанныхНеотфильтрованные
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДанныеУчетаВремени.Сотрудник КАК Сотрудник,
	ДанныеУчетаВремени.Месяц КАК Месяц,
	ДанныеУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
	ДанныеУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
	ДанныеУчетаВремени.Период КАК Дата,
	ДанныеУчетаВремени.ВидУчетаВремени КАК ВидУчетаВремени,
	ДанныеУчетаВремени.Территория КАК Территория,
	ИСТИНА КАК ЗарегистрированнаяТерритория,
	ЛОЖЬ КАК ПереходящаяЧастьПредыдущейСмены,
	ЛОЖЬ КАК ПереходящаяЧастьТекущейСмены,
	СУММА(ДанныеУчетаВремени.Дни) КАК Дни,
	СУММА(ДанныеУчетаВремени.Часы) КАК Часы,
	СУММА(ДанныеУчетаВремени.ДниПлан) КАК ДниПлан,
	СУММА(ДанныеУчетаВремени.ЧасыПлан) КАК ЧасыПлан,
	СУММА(ДанныеУчетаВремени.ДниНорма) КАК ДниНорма,
	СУММА(ДанныеУчетаВремени.ЧасыНорма) КАК ЧасыНорма
ПОМЕСТИТЬ ВТДанныеРегистровУчетаВремениПредварительно
ИЗ
	(ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник КАК Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц КАК Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
		ЛОЖЬ КАК План,
		ЛОЖЬ КАК ВЦеломЗаПериод,
		ДанныеРегистраУчетаВремени.Период КАК Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени КАК ВидУчетаВремени,
		ДанныеРегистраУчетаВремени.Территория КАК Территория,
		ДанныеРегистраУчетаВремени.УсловияТруда КАК УсловияТруда,
		ДанныеРегистраУчетаВремени.Дни КАК Дни,
		ДанныеРегистраУчетаВремени.Часы КАК Часы,
		0 КАК ДниПлан,
		0 КАК ЧасыПлан,
		0 КАК ДниНорма,
		0 КАК ЧасыНорма
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДанныеТабельногоУчетаРабочегоВремениСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета))
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
				И (НЕ ИсточникиПолученияДанныхУчетаВремени.ПолучатьРассчитанныеДанныеФакт)
				И (&ПолучатьНормуВремениЗаПолныйМесяц)) КАК ДанныеУчетаВремени

СГРУППИРОВАТЬ ПО
	ДанныеУчетаВремени.Сотрудник,
	ДанныеУчетаВремени.Месяц,
	ДанныеУчетаВремени.ДатаАктуальности,
	ДанныеУчетаВремени.ПериодРегистрации,
	ДанныеУчетаВремени.Период,
	ДанныеУчетаВремени.ВидУчетаВремени,
	ДанныеУчетаВремени.Территория
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПериодыРаботыСотрудников.Сотрудник КАК Сотрудник,
	ПериодыРаботыСотрудников.ДатаНачала КАК ДатаНачала,
	ПериодыРаботыСотрудников.ДатаОкончания КАК ДатаОкончания
ПОМЕСТИТЬ ВТСотрудникиБезПодатногоУчетаТерриторий
ИЗ
	ВТПараметрыЗарегистрированныхДанныхУчетаВремени КАК ПериодыРаботыСотрудников
ГДЕ
	НЕ 1 В
				(ВЫБРАТЬ ПЕРВЫЕ 1
					1
				ИЗ
					РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ДанныеУчетаРабочегоВремениСотрудников
				ГДЕ
					ДанныеУчетаРабочегоВремениСотрудников.ГрафикРаботы = ПериодыРаботыСотрудников.Сотрудник
					И ДанныеУчетаРабочегоВремениСотрудников.Месяц = ПериодыРаботыСотрудников.Месяц
					И ДанныеУчетаРабочегоВремениСотрудников.ПериодРегистрации = ПериодыРаботыСотрудников.ДатаАктуальности
					И ДанныеУчетаРабочегоВремениСотрудников.Территория <> ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА РегистрСведений.ДатаНачала <= НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
			ТОГДА НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
		ИНАЧЕ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ)
	КОНЕЦ КАК НачалоПериода,
	ВЫБОР
		КОГДА КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ) > ВЫБОР
				КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
			КОНЕЦ
			ТОГДА ВЫБОР
					КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
					ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
				КОНЕЦ
		ИНАЧЕ КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ)
	КОНЕЦ КАК КонецПериода,
	ИзмеренияДаты.ДатаНачала КАК ДатаНачала,
	ИзмеренияДаты.ДатаОкончания КАК ДатаОкончания,
	РегистрСведений.Сотрудник КАК Сотрудник,
	РегистрСведений.Территория КАК Территория
ПОМЕСТИТЬ ВТТерриторииСотрудников
ИЗ
	ВТСотрудникиБезПодатногоУчетаТерриторий КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТерриторииСотрудниковИнтервальный КАК РегистрСведений
		ПО (РегистрСведений.ДатаНачала >= ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ), ДЕНЬ, 1)
					И РегистрСведений.ДатаНачала <= ВЫБОР
						КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
						ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
					КОНЕЦ
				ИЛИ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ) <= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
					И РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТерриторииСотрудников.Сотрудник КАК Сотрудник,
	ТерриторииСотрудников.НачалоПериода КАК ДатаНачала,
	ТерриторииСотрудников.КонецПериода КАК ДатаОкончания,
	ТерриторииСотрудников.Территория КАК Территория
ПОМЕСТИТЬ ВТПериодыКадровыеТерритории
ИЗ
	ВТТерриторииСотрудников КАК ТерриторииСотрудников

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТерриторииСотрудников.Сотрудник,
	ТерриторииСотрудников.ДатаНачала,
	ДОБАВИТЬКДАТЕ(ТерриторииСотрудников.НачалоПериода, СЕКУНДА, -1),
	NULL
ИЗ
	ВТТерриторииСотрудников КАК ТерриторииСотрудников
		ЛЕВОЕ СОЕДИНЕНИЕ ВТТерриторииСотрудников КАК ТерриторииСотрудниковСлед
		ПО ТерриторииСотрудников.Сотрудник = ТерриторииСотрудниковСлед.Сотрудник
			И ТерриторииСотрудников.ДатаНачала = ТерриторииСотрудниковСлед.ДатаНачала
			И ТерриторииСотрудников.ДатаОкончания = ТерриторииСотрудниковСлед.ДатаОкончания
			И ТерриторииСотрудников.НачалоПериода > ТерриторииСотрудниковСлед.НачалоПериода
ГДЕ
	ТерриторииСотрудниковСлед.НачалоПериода ЕСТЬ NULL
	И ТерриторииСотрудников.НачалоПериода > ТерриторииСотрудников.ДатаНачала
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТСотрудникиБезПодатногоУчетаТерриторий
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТТерриторииСотрудников
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПараметрыПолученияДанныхОВремениПоДатам.Сотрудник КАК Сотрудник,
	ПараметрыПолученияДанныхОВремениПоДатам.Месяц КАК Месяц,
	ПараметрыПолученияДанныхОВремениПоДатам.Месяц КАК Период,
	ДОБАВИТЬКДАТЕ(ПараметрыПолученияДанныхОВремениПоДатам.Месяц, ДЕНЬ, 1) КАК ДатаНачала,
	КОНЕЦПЕРИОДА(ПараметрыПолученияДанныхОВремениПоДатам.Месяц, МЕСЯЦ) КАК ДатаОкончания
ПОМЕСТИТЬ ВТИзмеренияДатыДляСрезаГрафиков
ИЗ
	ВТИсточникиПолученияДанныхУчетаВремени КАК ПараметрыПолученияДанныхОВремениПоДатам
ГДЕ
	ПараметрыПолученияДанныхОВремениПоДатам.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА РегистрСведений.ПериодЗаписи = РегистрСведений.ДатаНачала
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ЭтоВозвратноеСобытие,
	РегистрСведений.ДатаОкончания КАК ДатаОкончания,
	РегистрСведений.ДатаНачала КАК ДатаНачала,
	РегистрСведений.Год КАК Год,
	РегистрСведений.ПериодПредыдущейЗаписи КАК ПериодПредыдущейЗаписи,
	РегистрСведений.Сотрудник КАК Сотрудник,
	РегистрСведений.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	ИзмеренияДаты.Период КАК Период,
	РегистрСведений.ДействуетДо КАК ПериодВозвратногоСобытия,
	РегистрСведений.РегистраторСобытия КАК Регистратор,
	РегистрСведений.РегистраторСобытия КАК РегистраторСобытия,
	РегистрСведений.РегистраторЗаписи КАК РегистраторЗаписи,
	РегистрСведений.ПериодЗаписи КАК ПериодЗаписи,
	РегистрСведений.ПустойИнтервал КАК ПустойИнтервал,
	РегистрСведений.ГрафикРаботы КАК ГрафикРаботы
ПОМЕСТИТЬ ВТГрафикРаботыСотрудниковСрезПоследних
{ВЫБРАТЬ
	Сотрудник,
	ГоловнаяОрганизация,
	Период,
	ПериодВозвратногоСобытия,
	Регистратор,
	РегистраторСобытия,
	РегистраторЗаписи,
	ПериодЗаписи,
	ПустойИнтервал,
	ГрафикРаботы}
ИЗ
	ВТИзмеренияДатыДляСрезаГрафиков КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикРаботыСотрудниковИнтервальный КАК РегистрСведений
		ПО (РегистрСведений.ДатаНачала <= ВЫБОР
				КОГДА ИзмеренияДаты.Период = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.Период, ДЕНЬ)
			КОНЕЦ)
			И (РегистрСведений.ДатаОкончания >= ВЫБОР
				КОГДА ИзмеренияДаты.Период = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.Период, ДЕНЬ)
			КОНЕЦ)
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МИНИМУМ(РегистрСведений.Период) КАК Период,
	ИзмеренияДаты.Период КАК ЗаданныйПериод,
	РегистрСведений.Сотрудник КАК Сотрудник,
	РегистрСведений.ГоловнаяОрганизация КАК ГоловнаяОрганизация
ПОМЕСТИТЬ ВТПериодыСрезаГрафикРаботыСотрудников
{ВЫБРАТЬ
	Период,
	ЗаданныйПериод,
	Сотрудник,
	ГоловнаяОрганизация}
ИЗ
	ВТИзмеренияДатыДляСрезаГрафиков КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикРаботыСотрудников КАК РегистрСведений
		ПО (РегистрСведений.Период >= ВЫБОР
				КОГДА ИзмеренияДаты.Период = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.Период, ДЕНЬ)
			КОНЕЦ)
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)

СГРУППИРОВАТЬ ПО
	ИзмеренияДаты.Период,
	РегистрСведений.Сотрудник,
	РегистрСведений.ГоловнаяОрганизация
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МаксимальныеПериоды.ЗаданныйПериод КАК Период,
	РегистрСведений.Период КАК ПериодЗаписи,
	РегистрСведений.ДействуетДо КАК ПериодВозвратногоСобытия,
	МаксимальныеПериоды.Сотрудник КАК Сотрудник,
	МаксимальныеПериоды.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	РегистрСведений.ГрафикРаботы КАК ГрафикРаботы,
	РегистрСведений.Активность КАК Активность,
	РегистрСведений.НомерСтроки КАК НомерСтроки,
	РегистрСведений.Регистратор КАК Регистратор
ПОМЕСТИТЬ ВТГрафикРаботыСотрудниковСрезПервых
{ВЫБРАТЬ
	Сотрудник,
	ГоловнаяОрганизация,
	ГрафикРаботы,
	Активность,
	НомерСтроки,
	Регистратор}
ИЗ
	ВТПериодыСрезаГрафикРаботыСотрудников КАК МаксимальныеПериоды
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикРаботыСотрудников КАК РегистрСведений
		ПО (РегистрСведений.Период = МаксимальныеПериоды.Период)
			И МаксимальныеПериоды.Сотрудник = РегистрСведений.Сотрудник
			И МаксимальныеПериоды.ГоловнаяОрганизация = РегистрСведений.ГоловнаяОрганизация
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТПериодыСрезаГрафикРаботыСотрудников
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РегистрСведений.ДатаНачала КАК ДатаНачала,
	РегистрСведений.ДатаОкончания КАК ДатаОкончания,
	РегистрСведений.Год КАК Год,
	РегистрСведений.Сотрудник КАК Сотрудник,
	РегистрСведений.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ) КАК Период,
	ВЫБОР
		КОГДА РегистрСведений.ПериодЗаписи = РегистрСведений.ДатаНачала
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ЭтоВозвратноеСобытие,
	РегистрСведений.ДействуетДо КАК ПериодВозвратногоСобытия,
	РегистрСведений.ДатаНачала КАК ПериодЗаписи,
	РегистрСведений.РегистраторСобытия КАК Регистратор,
	РегистрСведений.РегистраторСобытия КАК РегистраторСобытия,
	РегистрСведений.РегистраторЗаписи КАК РегистраторЗаписи,
	РегистрСведений.ПустойИнтервал КАК ПустойИнтервал,
	РегистрСведений.ГрафикРаботы КАК ГрафикРаботы
ПОМЕСТИТЬ ВТГрафикРаботыСотрудников
{ВЫБРАТЬ
	Сотрудник,
	ГоловнаяОрганизация,
	Период,
	ЭтоВозвратноеСобытие,
	ПериодВозвратногоСобытия,
	ПериодЗаписи,
	Регистратор,
	РегистраторСобытия,
	РегистраторЗаписи,
	ПустойИнтервал,
	ГрафикРаботы}
ИЗ
	ВТИзмеренияДатыДляСрезаГрафиков КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикРаботыСотрудниковИнтервальный КАК РегистрСведений
		ПО (РегистрСведений.ДатаНачала >= НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.ДатаНачала <= ВЫБОР
				КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
			КОНЕЦ)
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)
ГДЕ
	РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ГрафикРаботыСотрудниковСрезПервых.Сотрудник КАК Сотрудник,
	ГрафикРаботыСотрудниковСрезПервых.ГрафикРаботы КАК ГрафикРаботы,
	ГрафикРаботыСотрудниковСрезПервых.Период КАК Период,
	ИСТИНА КАК ТолькоПлановоеВремя
ПОМЕСТИТЬ ВТГрафикРаботыСотрудниковСрезПоследнихДополненный
ИЗ
	ВТГрафикРаботыСотрудниковСрезПервых КАК ГрафикРаботыСотрудниковСрезПервых
		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикРаботыСотрудниковСрезПоследних КАК ГрафикРаботыСотрудниковСрезПоследних
		ПО ГрафикРаботыСотрудниковСрезПервых.Сотрудник = ГрафикРаботыСотрудниковСрезПоследних.Сотрудник
			И ГрафикРаботыСотрудниковСрезПервых.Период = ГрафикРаботыСотрудниковСрезПоследних.Период
ГДЕ
	ГрафикРаботыСотрудниковСрезПоследних.Сотрудник ЕСТЬ NULL
	И &ПолучатьНормуВремениЗаПолныйМесяц

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ГрафикРаботыСотрудниковСрезПоследних.Сотрудник,
	ГрафикРаботыСотрудниковСрезПоследних.ГрафикРаботы,
	ГрафикРаботыСотрудниковСрезПоследних.Период,
	ЛОЖЬ
ИЗ
	ВТГрафикРаботыСотрудниковСрезПоследних КАК ГрафикРаботыСотрудниковСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ГрафикРаботыСотрудниковСрезПоследних.Сотрудник КАК Сотрудник,
	ГрафикРаботыСотрудниковСрезПоследних.ГрафикРаботы КАК ГрафикРаботы,
	ГрафикРаботыСотрудниковСрезПоследних.Период КАК Период,
	ГрафикРаботыСотрудниковСрезПоследних.ТолькоПлановоеВремя КАК ТолькоПлановоеВремя
ПОМЕСТИТЬ ВТГрафикиСотрудниковСрезИДвижения
ИЗ
	ВТГрафикРаботыСотрудниковСрезПоследнихДополненный КАК ГрафикРаботыСотрудниковСрезПоследних

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ГрафикРаботыСотрудников.Сотрудник,
	ГрафикРаботыСотрудников.ГрафикРаботы,
	ГрафикРаботыСотрудников.Период,
	ЛОЖЬ
ИЗ
	ВТГрафикРаботыСотрудников КАК ГрафикРаботыСотрудников
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПараметрыРасчетаВремениСотрудников.Сотрудник КАК Сотрудник,
	ПараметрыРасчетаВремениСотрудников.Месяц КАК Месяц,
	ПериодыГрафиков.Период КАК ДатаНачала,
	МИНИМУМ(ВЫБОР
			КОГДА ПериодыГрафиковСлед.Период ЕСТЬ NULL
				ТОГДА ПараметрыРасчетаВремениСотрудников.ДатаОкончания
			ИНАЧЕ ДОБАВИТЬКДАТЕ(ПериодыГрафиковСлед.Период, СЕКУНДА, -1)
		КОНЕЦ) КАК ДатаОкончания,
	ПериодыГрафиков.ТолькоПлановоеВремя КАК ТолькоПлановоеВремя
ПОМЕСТИТЬ ВТИнтервалыГрафиков
ИЗ
	ВТИзмеренияДатыДляСрезаГрафиков КАК ПараметрыРасчетаВремениСотрудников
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТГрафикиСотрудниковСрезИДвижения КАК ПериодыГрафиков
		ПО ПараметрыРасчетаВремениСотрудников.Сотрудник = ПериодыГрафиков.Сотрудник
			И ПараметрыРасчетаВремениСотрудников.Месяц <= ПериодыГрафиков.Период
			И ПараметрыРасчетаВремениСотрудников.ДатаОкончания >= ПериодыГрафиков.Период
		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиСотрудниковСрезИДвижения КАК ПериодыГрафиковСлед
		ПО ПараметрыРасчетаВремениСотрудников.Сотрудник = ПериодыГрафиковСлед.Сотрудник
			И (ПериодыГрафиков.Период < ПериодыГрафиковСлед.Период)
			И ПараметрыРасчетаВремениСотрудников.ДатаОкончания >= ПериодыГрафиковСлед.Период

СГРУППИРОВАТЬ ПО
	ПараметрыРасчетаВремениСотрудников.Сотрудник,
	ПараметрыРасчетаВремениСотрудников.Месяц,
	ПериодыГрафиков.ТолькоПлановоеВремя,
	ПериодыГрафиков.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИнтервалыГрафиков.Сотрудник КАК Сотрудник,
	ИнтервалыГрафиков.Месяц КАК Месяц,
	ИнтервалыГрафиков.ДатаНачала КАК ДатаНачала,
	ИнтервалыГрафиков.ДатаОкончания КАК ДатаОкончания,
	ГрафикиСотрудниковСрезИДвижения.ГрафикРаботы КАК ГрафикРаботы,
	ВЫБОР
		КОГДА ГрафикиРаботыСотрудников.ГрафикПолногоРабочегоВремени = ЗНАЧЕНИЕ(Справочник.ГрафикиРаботыСотрудников.ПустаяСсылка)
			ТОГДА ГрафикиРаботыСотрудников.Ссылка
		ИНАЧЕ ГрафикиРаботыСотрудников.ГрафикПолногоРабочегоВремени
	КОНЕЦ КАК ГрафикРаботыНорма,
	ИнтервалыГрафиков.ТолькоПлановоеВремя КАК ТолькоПлановоеВремя
ПОМЕСТИТЬ ВТПериодыДействияОбщихГрафиковСотрудников
ИЗ
	ВТИнтервалыГрафиков КАК ИнтервалыГрафиков
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТГрафикиСотрудниковСрезИДвижения КАК ГрафикиСотрудниковСрезИДвижения
		ПО ИнтервалыГрафиков.Сотрудник = ГрафикиСотрудниковСрезИДвижения.Сотрудник
			И ИнтервалыГрафиков.ДатаНачала = ГрафикиСотрудниковСрезИДвижения.Период
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ГрафикиРаботыСотрудников КАК ГрафикиРаботыСотрудников
		ПО (ГрафикиСотрудниковСрезИДвижения.ГрафикРаботы = ГрафикиРаботыСотрудников.Ссылка)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПериодыДействияОбщихГрафиковСотрудников.Месяц КАК Месяц,
	ВЫБОР
		КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
			ТОГДА ДОБАВИТЬКДАТЕ(ПериодыДействияОбщихГрафиковСотрудников.Месяц, МЕСЯЦ, 1)
		ИНАЧЕ ПериодыДействияОбщихГрафиковСотрудников.Месяц
	КОНЕЦ КАК МесяцОкончание,
	ПериодыДействияОбщихГрафиковСотрудников.ГрафикРаботы КАК ГрафикРаботы,
	ВЫБОР
		КОГДА ГрафикиРаботыСотрудников.ГрафикПолногоРабочегоВремени = ЗНАЧЕНИЕ(Справочник.ГрафикиРаботыСотрудников.ПустаяСсылка)
			ТОГДА ПериодыДействияОбщихГрафиковСотрудников.ГрафикРаботы
		ИНАЧЕ ГрафикиРаботыСотрудников.ГрафикПолногоРабочегоВремени
	КОНЕЦ КАК ГрафикРаботыНорма
ПОМЕСТИТЬ ВТОбщиеГрафики
ИЗ
	ВТПериодыДействияОбщихГрафиковСотрудников КАК ПериодыДействияОбщихГрафиковСотрудников
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ГрафикиРаботыСотрудников КАК ГрафикиРаботыСотрудников
		ПО ПериодыДействияОбщихГрафиковСотрудников.ГрафикРаботы = ГрафикиРаботыСотрудников.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТИзмеренияДатыДляСрезаГрафиков
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТГрафикРаботыСотрудниковСрезПервых
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТГрафикРаботыСотрудниковСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТГрафикРаботыСотрудниковСрезПоследнихДополненный
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТГрафикРаботыСотрудников
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТГрафикиСотрудниковСрезИДвижения
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТИнтервалыГрафиков
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ОбщиеГрафики.ГрафикРаботы КАК ГрафикРаботы,
	ОбщиеГрафики.Месяц КАК Месяц,
	ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ОсновноеЗначение, 0) КАК Дней,
	ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение, 0) КАК Часов,
	ВЫБОР
		КОГДА ОбщиеГрафики.ГрафикРаботы = ОбщиеГрафики.ГрафикРаботыНорма
			ТОГДА ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ОсновноеЗначение, 0)
		ИНАЧЕ 0
	КОНЕЦ КАК ДнейНорма,
	ВЫБОР
		КОГДА ОбщиеГрафики.ГрафикРаботы = ОбщиеГрафики.ГрафикРаботыНорма
			ТОГДА ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение, 0)
		ИНАЧЕ 0
	КОНЕЦ КАК ЧасовНорма,
	ГрафикиРаботыПоВидамВремени.Дата КАК Дата,
	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени КАК ВидУчетаВремени,
	ГрафикиРаботыПоВидамВремени.Смена КАК Смена,
	ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьПредыдущейСмены КАК ПереходящаяЧастьПредыдущейСмены,
	ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьТекущейСмены КАК ПереходящаяЧастьТекущейСмены,
	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени.ОсновноеВремя КАК ОсновноеВремя
ПОМЕСТИТЬ ВТДанныеОбщихГрафиков
ИЗ
	ВТОбщиеГрафики КАК ОбщиеГрафики
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
		ПО ОбщиеГрафики.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			И (ГрафикиРаботыПоВидамВремени.Месяц МЕЖДУ ОбщиеГрафики.Месяц И ОбщиеГрафики.МесяцОкончание)
			И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ ОбщиеГрафики.Месяц И ДОБАВИТЬКДАТЕ(КОНЕЦПЕРИОДА(ОбщиеГрафики.Месяц, МЕСЯЦ), ДЕНЬ, 1))
			И (НЕ ГрафикиРаботыПоВидамВремени.ВремяВЧасах)
			И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени <> &РабочееВремя)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ОбщиеГрафики.ГрафикРаботы,
	ОбщиеГрафики.Месяц,
	0,
	0,
	ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеНорма, 0),
	ЕСТЬNULL(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначениеНорма, 0),
	ГрафикиРаботыПоВидамВремени.Дата,
	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени,
	ЗНАЧЕНИЕ(Справочник.СменыРаботыСотрудников.ПустаяСсылка),
	ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьПредыдущейСмены,
	ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьТекущейСмены,
	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени.ОсновноеВремя
ИЗ
	ВТОбщиеГрафики КАК ОбщиеГрафики
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
		ПО ОбщиеГрафики.ГрафикРаботыНорма = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			И (ГрафикиРаботыПоВидамВремени.Месяц МЕЖДУ ОбщиеГрафики.Месяц И ОбщиеГрафики.МесяцОкончание)
			И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ ОбщиеГрафики.Месяц И ДОБАВИТЬКДАТЕ(КОНЕЦПЕРИОДА(ОбщиеГрафики.Месяц, МЕСЯЦ), ДЕНЬ, 1))
			И (НЕ ГрафикиРаботыПоВидамВремени.ВремяВЧасах)
			И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
			И (ОбщиеГрафики.ГрафикРаботыНорма <> ОбщиеГрафики.ГрафикРаботы)
			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени <> &РабочееВремя)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДанныеУчетаВремени.Сотрудник КАК Сотрудник,
	ДанныеУчетаВремени.Месяц КАК Месяц,
	ДанныеУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
	ДанныеУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
	МИНИМУМ(ДанныеУчетаВремени.План) КАК План,
	ДанныеУчетаВремени.ВЦеломЗаПериод КАК ВЦеломЗаПериод,
	ВЫБОР
		КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
				И ДанныеУчетаВремени.ПереходящаяЧастьПредыдущейСмены
			ТОГДА ДОБАВИТЬКДАТЕ(ДанныеУчетаВремени.Период, ДЕНЬ, -1)
		ИНАЧЕ ДанныеУчетаВремени.Период
	КОНЕЦ КАК Дата,
	ДанныеУчетаВремени.ВидУчетаВремени КАК ВидУчетаВремени,
	ДанныеУчетаВремени.Территория КАК Территория,
	ДанныеУчетаВремени.УсловияТруда КАК УсловияТруда,
	ВЫБОР
		КОГДА ДанныеУчетаВремени.ВЦеломЗаПериод
			ТОГДА СУММА(ДанныеУчетаВремени.Дни)
		КОГДА СУММА(ДанныеУчетаВремени.Дни) > 0
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК Дни,
	СУММА(ДанныеУчетаВремени.Часы) КАК Часы,
	МАКСИМУМ(ДанныеУчетаВремени.ЗарегистрированнаяТерритория) КАК ЗарегистрированнаяТерритория,
	МАКСИМУМ(ДанныеУчетаВремени.ДниПлан) КАК ДниПлан,
	СУММА(ДанныеУчетаВремени.ЧасыПлан) КАК ЧасыПлан,
	МАКСИМУМ(ДанныеУчетаВремени.ДниНорма) КАК ДниНорма,
	СУММА(ДанныеУчетаВремени.ЧасыНорма) КАК ЧасыНорма,
	МАКСИМУМ(ДанныеУчетаВремени.Смена) КАК Смена,
	ДанныеУчетаВремени.ПереходящаяЧастьПредыдущейСмены КАК ПереходящаяЧастьПредыдущейСмены,
	ДанныеУчетаВремени.ПереходящаяЧастьТекущейСмены КАК ПереходящаяЧастьТекущейСмены
ПОМЕСТИТЬ ВТДанныеРегистровУчетаВремени
ИЗ
	(ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник КАК Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц КАК Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
		ЛОЖЬ КАК План,
		ЛОЖЬ КАК ВЦеломЗаПериод,
		ДанныеРегистраУчетаВремени.Период КАК Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени КАК ВидУчетаВремени,
		ДанныеРегистраУчетаВремени.Смена КАК Смена,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены КАК ПереходящаяЧастьПредыдущейСмены,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьТекущейСмены КАК ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка) КАК Территория,
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка) КАК УсловияТруда,
		ДанныеРегистраУчетаВремени.Дни КАК Дни,
		ДанныеРегистраУчетаВремени.Часы КАК Часы,
		ИСТИНА КАК ЗарегистрированнаяТерритория,
		0 КАК ДниПлан,
		0 КАК ЧасыПлан,
		0 КАК ДниНорма,
		0 КАК ЧасыНорма
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДанныеТабельногоУчетаРабочегоВремениСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаНачала
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСменыНаНачалоПериода)
					ИЛИ НЕ ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСменыНаКонецПериода)
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСмены)
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеТабельногоУчета))
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ЛОЖЬ,
		ЛОЖЬ,
		ДанныеРегистраУчетаВремени.Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени,
		ДанныеРегистраУчетаВремени.Смена,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		ДанныеРегистраУчетаВремени.Дни,
		ДанныеРегистраУчетаВремени.Часы,
		ЛОЖЬ,
		0,
		0,
		0,
		0
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДанныеОперативногоУчетаРабочегоВремениСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаНачала
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСменыНаНачалоПериода)
					ИЛИ НЕ ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСменыНаКонецПериода)
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСмены)
				И ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ДанныеРегистраУчетаВремени.ВидДанных
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ЛОЖЬ,
		ЛОЖЬ,
		ДанныеРегистраУчетаВремени.Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени,
		ДанныеРегистраУчетаВремени.Смена,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		0,
		-ДанныеРегистраУчетаВремени.Часы,
		ЛОЖЬ,
		0,
		0,
		0,
		0
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ВытесняемоеПлановоеВремяСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаНачала
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСменыНаНачалоПериода)
					ИЛИ НЕ ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСменыНаКонецПериода)
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСмены)
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ВытесняемоеПлановоеВремя))
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ЛОЖЬ,
		ИСТИНА,
		ДанныеРегистраУчетаВремени.Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени,
		ЗНАЧЕНИЕ(Справочник.СменыРаботыСотрудников.ПустаяСсылка),
		ЛОЖЬ,
		ЛОЖЬ,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		СУММА(ДанныеРегистраУчетаВремени.Дни),
		СУММА(ДанныеРегистраУчетаВремени.Часы),
		ЛОЖЬ,
		0,
		0,
		0,
		0
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДанныеСводногоУчетаРабочегоВремениСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.СводныеДанные))
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
	
	СГРУППИРОВАТЬ ПО
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ДанныеРегистраУчетаВремени.Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ,
		ЛОЖЬ,
		ДанныеРегистраУчетаВремени.Период,
		ДанныеРегистраУчетаВремени.ВидУчетаВремени,
		ДанныеРегистраУчетаВремени.Смена,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены,
		ДанныеРегистраУчетаВремени.ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ДанныеРегистраУчетаВремени.Дни
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ДанныеРегистраУчетаВремени.Часы
			ИНАЧЕ 0
		КОНЕЦ,
		ЛОЖЬ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеРегистраУчетаВремени.Дни
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеРегистраУчетаВремени.Часы
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеРегистраУчетаВремени.Дни
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеРегистраУчетаВремени.Часы
			ИНАЧЕ 0
		КОНЕЦ
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДанныеИндивидуальныхГрафиковСотрудников КАК ДанныеРегистраУчетаВремени
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ДанныеРегистраУчетаВремени.Сотрудник
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаНачала
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСменыНаНачалоПериода)
					ИЛИ НЕ ДанныеРегистраУчетаВремени.ПереходящаяЧастьПредыдущейСмены
						И (ДанныеРегистраУчетаВремени.Период <> ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСменыНаКонецПериода)
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСмены)
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеИндивидуальныхГрафиков))
				И ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности >= ДанныеРегистраУчетаВремени.ПериодРегистрации
				И (ДанныеРегистраУчетаВремени.Период МЕЖДУ &ДатаНачала И ДОБАВИТЬКДАТЕ(&ДатаОкончания, ДЕНЬ, 1))
				И (ИСТИНА)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИсточникиПолученияДанныхУчетаВремени.Сотрудник,
		ИсточникиПолученияДанныхУчетаВремени.Месяц,
		ИсточникиПолученияДанныхУчетаВремени.ДатаАктуальности,
		ИсточникиПолученияДанныхУчетаВремени.ПериодРегистрации,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ,
		ЛОЖЬ,
		ДанныеОбщихГрафиков.Дата,
		ДанныеОбщихГрафиков.ВидУчетаВремени,
		ДанныеОбщихГрафиков.Смена,
		ДанныеОбщихГрафиков.ПереходящаяЧастьПредыдущейСмены,
		ДанныеОбщихГрафиков.ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		ВЫБОР
			КОГДА НЕ ПериодыДействияОбщихГрафиковСотрудников.ТолькоПлановоеВремя
					И ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ДанныеОбщихГрафиков.Дней
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА НЕ ПериодыДействияОбщихГрафиковСотрудников.ТолькоПлановоеВремя
					И ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеФакт
				ТОГДА ДанныеОбщихГрафиков.Часов
			ИНАЧЕ 0
		КОНЕЦ,
		ЛОЖЬ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеОбщихГрафиков.Дней
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеОбщихГрафиков.Часов
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеОбщихГрафиков.ДнейНорма
			ИНАЧЕ 0
		КОНЕЦ,
		ВЫБОР
			КОГДА ИсточникиПолученияДанныхУчетаВремени.ПолучатьДанныеПлан
				ТОГДА ДанныеОбщихГрафиков.ЧасовНорма
			ИНАЧЕ 0
		КОНЕЦ
	ИЗ
		ВТИсточникиПолученияДанныхУчетаВремени КАК ИсточникиПолученияДанныхУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПериодыДействияОбщихГрафиковСотрудников КАК ПериодыДействияОбщихГрафиковСотрудников
			ПО ИсточникиПолученияДанныхУчетаВремени.Сотрудник = ПериодыДействияОбщихГрафиковСотрудников.Сотрудник
				И (ИсточникиПолученияДанныхУчетаВремени.ВидДанных = ЗНАЧЕНИЕ(Перечисление.ВидыДанныхУчетаВремениСотрудников.ДанныеОбщихГрафиков))
				И ИсточникиПолученияДанныхУчетаВремени.Месяц = ПериодыДействияОбщихГрафиковСотрудников.Месяц
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДанныеОбщихГрафиков КАК ДанныеОбщихГрафиков
			ПО (ПериодыДействияОбщихГрафиковСотрудников.ГрафикРаботы = ДанныеОбщихГрафиков.ГрафикРаботы)
				И (ДанныеОбщихГрафиков.Дата МЕЖДУ ИсточникиПолученияДанныхУчетаВремени.ДатаНачала И ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания)
				И (ДанныеОбщихГрафиков.ПереходящаяЧастьПредыдущейСмены
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСмены
						И (ДанныеОбщихГрафиков.Дата <> ИсточникиПолученияДанныхУчетаВремени.ДатаНачала
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьПереходящуюЧастьСменыНаНачалоПериода)
					ИЛИ НЕ ДанныеОбщихГрафиков.ПереходящаяЧастьПредыдущейСмены
						И (ДанныеОбщихГрафиков.Дата <> ИсточникиПолученияДанныхУчетаВремени.ДатаОкончания
							ИЛИ ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСменыНаКонецПериода)
						И ИсточникиПолученияДанныхУчетаВремени.ПолучатьОсновнуюЧастьСмены)
				И (ПериодыДействияОбщихГрафиковСотрудников.ДатаНачала <= ДанныеОбщихГрафиков.Дата)
				И (ПериодыДействияОбщихГрафиковСотрудников.ДатаОкончания >= ДанныеОбщихГрафиков.Дата
					ИЛИ ДанныеОбщихГрафиков.Дата = ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ПериодыДействияОбщихГрафиковСотрудников.ДатаОкончания, ДЕНЬ), ДЕНЬ, 1)
						И ДанныеОбщихГрафиков.ПереходящаяЧастьПредыдущейСмены)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПараметрыПолученияДанныхПоСотрудникам.Сотрудник,
		ПараметрыПолученияДанныхПоСотрудникам.Месяц,
		ПараметрыПолученияДанныхПоСотрудникам.ДатаАктуальности,
		ПараметрыПолученияДанныхПоСотрудникам.ПериодРегистрации,
		ГрафикиРаботыПоВидамВремени.План,
		ГрафикиРаботыПоВидамВремени.ВЦеломЗаПериод,
		ГрафикиРаботыПоВидамВремени.Дата,
		ГрафикиРаботыПоВидамВремени.ВидУчетаВремени,
		ГрафикиРаботыПоВидамВремени.Смена,
		ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьПредыдущейСмены,
		ГрафикиРаботыПоВидамВремени.ПереходящаяЧастьТекущейСмены,
		ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка),
		ЗНАЧЕНИЕ(Справочник.УсловияТруда.ПустаяСсылка),
		ГрафикиРаботыПоВидамВремени.ОсновноеЗначение,
		ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение,
		ЛОЖЬ,
		0,
		0,
		ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеНорма,
		ГрафикиРаботыПоВидамВремени.ДополнительноеЗначениеНорма
	ИЗ
		ВТПараметрыПолученияДанныхПоСотрудникам КАК ПараметрыПолученияДанныхПоСотрудникам
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			ПО ПараметрыПолученияДанныхПоСотрудникам.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
				И ПараметрыПолученияДанныхПоСотрудникам.Месяц = ГрафикиРаботыПоВидамВремени.Месяц
				И ПараметрыПолученияДанныхПоСотрудникам.ПериодРегистрации = ГрафикиРаботыПоВидамВремени.ПериодРегистрации
				И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ ПараметрыПолученияДанныхПоСотрудникам.ДатаНачала И ПараметрыПолученияДанныхПоСотрудникам.ДатаОкончания)
				И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени <> &РабочееВремя)
				И (НЕ ГрафикиРаботыПоВидамВремени.ВремяВЧасах)
				И (ПараметрыПолученияДанныхПоСотрудникам.ПолучатьРассчитанныеДанныеФакт)) КАК ДанныеУчетаВремени

СГРУППИРОВАТЬ ПО
	ДанныеУчетаВремени.Сотрудник,
	ДанныеУчетаВремени.Месяц,
	ДанныеУчетаВремени.ДатаАктуальности,
	ДанныеУчетаВремени.ПериодРегистрации,
	ДанныеУчетаВремени.ВЦеломЗаПериод,
	ДанныеУчетаВремени.Период,
	ДанныеУчетаВремени.ВидУчетаВремени,
	ДанныеУчетаВремени.Территория,
	ДанныеУчетаВремени.УсловияТруда,
	ДанныеУчетаВремени.ПереходящаяЧастьПредыдущейСмены,
	ДанныеУчетаВремени.ПереходящаяЧастьТекущейСмены
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТПериодыДействияОбщихГрафиковСотрудников
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТОбщиеГрафики
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТДанныеОбщихГрафиков
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДанныеРегистровУчетаВремени.Сотрудник КАК Сотрудник,
	ДанныеРегистровУчетаВремени.Месяц КАК Месяц,
	ДанныеРегистровУчетаВремени.ДатаАктуальности КАК ДатаАктуальности,
	ДанныеРегистровУчетаВремени.ПериодРегистрации КАК ПериодРегистрации,
	ДанныеРегистровУчетаВремени.Дата КАК Дата,
	ДанныеРегистровУчетаВремени.ПереходящаяЧастьПредыдущейСмены КАК ПереходящаяЧастьПредыдущейСмены,
	ДанныеРегистровУчетаВремени.ПереходящаяЧастьТекущейСмены КАК ПереходящаяЧастьТекущейСмены,
	МАКСИМУМ(ДанныеРегистровУчетаВремени.ДниНорма) КАК ДниНорма,
	СУММА(ДанныеРегистровУчетаВремени.ЧасыНорма) КАК ЧасыНорма,
	МАКСИМУМ(ДанныеРегистровУчетаВремени.ДниПлан) КАК ДниПлан,
	СУММА(ДанныеРегистровУчетаВремени.ЧасыПлан) КАК ЧасыПлан
ПОМЕСТИТЬ ВТНормаВремени
ИЗ
	ВТДанныеРегистровУчетаВремени КАК ДанныеРегистровУчетаВремени
ГДЕ
	ДанныеРегистровУчетаВремени.ВидУчетаВремени.ОсновноеВремя В(&ВидыВремениВключаемыеВНорму)
	И &ПолучатьДанныеНорма

СГРУППИРОВАТЬ ПО
	ДанныеРегистровУчетаВремени.Сотрудник,
	ДанныеРегистровУчетаВремени.Месяц,
	ДанныеРегистровУчетаВремени.ДатаАктуальности,
	ДанныеРегистровУчетаВремени.ПериодРегистрации,
	ДанныеРегистровУчетаВремени.Дата,
	ДанныеРегистровУчетаВремени.ПереходящаяЧастьПредыдущейСмены,
	ДанныеРегистровУчетаВремени.ПереходящаяЧастьТекущейСмены
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДанныеРегистровУчетаВремени.Сотрудник КАК Сотрудник,
	ДанныеРегистровУчетаВремени.Месяц КАК Месяц,
	ДанныеРегистровУчетаВремени.Дата КАК Дата,
	ДанныеРегистровУчетаВремени.ВидУчетаВремени КАК ВидУчетаВремени,
	ДанныеРегистровУчетаВремени.ВидУчетаВремени.ОсновноеВремя КАК ОсновноеВремя,
	ДанныеРегистровУчетаВремени.Территория КАК Территория,
	ДанныеРегистровУчетаВремени.ПереходящаяЧастьПредыдущейСмены КАК ПереходящаяЧастьПредыдущейСмены,
	ДанныеРегистровУчетаВремени.Дни КАК Дней,
	ДанныеРегистровУчетаВремени.Часы КАК Часов
ПОМЕСТИТЬ ВТДанныеУчетаРабочегоВремениСотрудников
ИЗ
	ВТДанныеРегистровУчетаВремени КАК ДанныеРегистровУчетаВремени
ГДЕ
	(ДанныеРегистровУчетаВремени.Часы <> 0
			ИЛИ ДанныеРегистровУчетаВремени.Дни <> 0
				И (НЕ ДанныеРегистровУчетаВремени.ВидУчетаВремени.РабочееВремя
					ИЛИ ДанныеРегистровУчетаВремени.ВидУчетаВремени В (&ВидыВремениПраздники)))

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НормаВремени.Сотрудник,
	НормаВремени.Месяц,
	НормаВремени.Дата,
	&РабочееВремя,
	&РабочееВремя,
	ЕСТЬNULL(ДанныеРегистровУчетаВремени.Территория, ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка)),
	НормаВремени.ПереходящаяЧастьПредыдущейСмены,
	МАКСИМУМ(ДанныеРегистровУчетаВремени.Дни),
	СУММА(ДанныеРегистровУчетаВремени.Часы)
ИЗ
	ВТНормаВремени КАК НормаВремени
		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеРегистровУчетаВремени КАК ДанныеРегистровУчетаВремени
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ВидыИспользованияРабочегоВремени КАК ВидыИспользованияРабочегоВремени
			ПО ДанныеРегистровУчетаВремени.ВидУчетаВремени = ВидыИспользованияРабочегоВремени.Ссылка
				И (ВидыИспользованияРабочегоВремени.ОсновноеВремя В (&ВидыВремениВключаемыеВНорму))
		ПО НормаВремени.Сотрудник = ДанныеРегистровУчетаВремени.Сотрудник
			И НормаВремени.Месяц = ДанныеРегистровУчетаВремени.Месяц
			И НормаВремени.ДатаАктуальности = ДанныеРегистровУчетаВремени.ДатаАктуальности
			И НормаВремени.ПериодРегистрации = ДанныеРегистровУчетаВремени.ПериодРегистрации
			И НормаВремени.Дата = ДанныеРегистровУчетаВремени.Дата
			И НормаВремени.ПереходящаяЧастьПредыдущейСмены = ДанныеРегистровУчетаВремени.ПереходящаяЧастьПредыдущейСмены
			И НормаВремени.ПереходящаяЧастьТекущейСмены = ДанныеРегистровУчетаВремени.ПереходящаяЧастьТекущейСмены
			И (ДанныеРегистровУчетаВремени.Часы <> 0
				ИЛИ ДанныеРегистровУчетаВремени.Дни <> 0
					И (НЕ ВидыИспользованияРабочегоВремени.РабочееВремя
						ИЛИ ДанныеРегистровУчетаВремени.ВидУчетаВремени В (&ВидыВремениПраздники)))

СГРУППИРОВАТЬ ПО
	НормаВремени.Сотрудник,
	НормаВремени.Месяц,
	НормаВремени.Дата,
	ЕСТЬNULL(ДанныеРегистровУчетаВремени.Территория, ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка)),
	НормаВремени.ПереходящаяЧастьПредыдущейСмены

ИМЕЮЩИЕ
	(МАКСИМУМ(НормаВремени.ДниНорма) <> 0
		ИЛИ МАКСИМУМ(НормаВремени.ЧасыНорма) <> 0
		ИЛИ МАКСИМУМ(ДанныеРегистровУчетаВремени.Дни) <> 0
		ИЛИ СУММА(ДанныеРегистровУчетаВремени.Часы) <> 0)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПериодыРаботыСотрудников.Сотрудник КАК Сотрудник,
	ПериодыРаботыСотрудников.ДатаНачала КАК ДатаНачала,
	ПериодыРаботыСотрудников.ДатаОкончания КАК ДатаОкончания
ПОМЕСТИТЬ ВТСотрудникиБезПодатногоУчетаТерриторий
ИЗ
	ВТСотрудникиМесяцы КАК ПериодыРаботыСотрудников
ГДЕ
	НЕ 1 В
				(ВЫБРАТЬ ПЕРВЫЕ 1
					1
				ИЗ
					ВТДанныеУчетаРабочегоВремениСотрудников КАК ДанныеУчетаРабочегоВремениСотрудников
				ГДЕ
					ДанныеУчетаРабочегоВремениСотрудников.Сотрудник = ПериодыРаботыСотрудников.Сотрудник
					И ДанныеУчетаРабочегоВремениСотрудников.Месяц = ПериодыРаботыСотрудников.Месяц
					И ДанныеУчетаРабочегоВремениСотрудников.Территория <> ЗНАЧЕНИЕ(Справочник.ТерриторииВыполненияРабот.ПустаяСсылка))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВЫБОР
		КОГДА РегистрСведений.ДатаНачала <= НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
			ТОГДА НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
		ИНАЧЕ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ)
	КОНЕЦ КАК НачалоПериода,
	ВЫБОР
		КОГДА КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ) > ВЫБОР
				КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
			КОНЕЦ
			ТОГДА ВЫБОР
					КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
						ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
					ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
				КОНЕЦ
		ИНАЧЕ КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(РегистрСведений.ДатаОкончания, СЕКУНДА, -86399), ДЕНЬ)
	КОНЕЦ КАК КонецПериода,
	ИзмеренияДаты.ДатаНачала КАК ДатаНачала,
	ИзмеренияДаты.ДатаОкончания КАК ДатаОкончания,
	РегистрСведений.Сотрудник КАК Сотрудник
ПОМЕСТИТЬ ВТТерриторииСотрудников
ИЗ
	ВТСотрудникиБезПодатногоУчетаТерриторий КАК ИзмеренияДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТерриторииСотрудниковИнтервальный КАК РегистрСведений
		ПО (РегистрСведений.ДатаНачала >= ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ), ДЕНЬ, 1)
					И РегистрСведений.ДатаНачала <= ВЫБОР
						КОГДА ИзмеренияДаты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1)
							ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
						ИНАЧЕ КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаОкончания, ДЕНЬ)
					КОНЕЦ
				ИЛИ НАЧАЛОПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ) <= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ)
					И РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(ИзмеренияДаты.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.ДатаОкончания >= КОНЕЦПЕРИОДА(РегистрСведений.ДатаНачала, ДЕНЬ))
			И (РегистрСведений.Сотрудник = ИзмеренияДаты.Сотрудник)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТерриторииСотрудников.Сотрудник КАК Сотрудник,
	ТерриторииСотрудников.НачалоПериода КАК ДатаНачала,
	ТерриторииСотрудников.КонецПериода КАК ДатаОкончания
ПОМЕСТИТЬ ВТПериодыТерриторий
ИЗ
	ВТТерриторииСотрудников КАК ТерриторииСотрудников

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТерриторииСотрудников.Сотрудник,
	ТерриторииСотрудников.ДатаНачала,
	ДОБАВИТЬКДАТЕ(ТерриторииСотрудников.НачалоПериода, СЕКУНДА, -1)
ИЗ
	ВТТерриторииСотрудников КАК ТерриторииСотрудников
		ЛЕВОЕ СОЕДИНЕНИЕ ВТТерриторииСотрудников КАК ТерриторииСотрудниковСлед
		ПО ТерриторииСотрудников.Сотрудник = ТерриторииСотрудниковСлед.Сотрудник
			И ТерриторииСотрудников.ДатаНачала = ТерриторииСотрудниковСлед.ДатаНачала
			И ТерриторииСотрудников.ДатаОкончания = ТерриторииСотрудниковСлед.ДатаОкончания
			И ТерриторииСотрудников.НачалоПериода > ТерриторииСотрудниковСлед.НачалоПериода
ГДЕ
	ТерриторииСотрудниковСлед.НачалоПериода ЕСТЬ NULL
	И ТерриторииСотрудников.НачалоПериода > ТерриторииСотрудников.ДатаНачала
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТСотрудникиБезПодатногоУчетаТерриторий
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТТерриторииСотрудников
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СотрудникиМесяцы.Сотрудник КАК Сотрудник,
	СостоянияСотрудниковСрезПоследних.Состояние КАК Состояние,
	СотрудникиМесяцы.ДатаНачала КАК НачалоПериода,
	ВЫБОР
		КОГДА СостоянияСотрудниковСрезПоследних.ДействуетДо = ДАТАВРЕМЯ(1, 1, 1)
				ИЛИ СостоянияСотрудниковСрезПоследних.ДействуетДо > СотрудникиМесяцы.ДатаОкончания
			ТОГДА ВЫБОР
					КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						ТОГДА ДОБАВИТЬКДАТЕ(СотрудникиМесяцы.ДатаОкончания, ДЕНЬ, 1)
					ИНАЧЕ СотрудникиМесяцы.ДатаОкончания
				КОНЕЦ
		ИНАЧЕ СостоянияСотрудниковСрезПоследних.ДействуетДо
	КОНЕЦ КАК ОкончаниеПериода,
	СостоянияСотрудниковСрезПоследних.ВидВремени КАК ВидВремени
ПОМЕСТИТЬ ВТСостоянияСотрудников
ИЗ
	РегистрСведений.СостоянияСотрудников КАК СостоянияСотрудниковСрезПоследних
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСотрудникиМесяцы КАК СотрудникиМесяцы
		ПО СостоянияСотрудниковСрезПоследних.Сотрудник = СотрудникиМесяцы.ГоловнойСотрудник
			И СостоянияСотрудниковСрезПоследних.Период <= СотрудникиМесяцы.ДатаНачала
			И (СостоянияСотрудниковСрезПоследних.ДействуетДо = ДАТАВРЕМЯ(1, 1, 1)
				ИЛИ СостоянияСотрудниковСрезПоследних.ДействуетДо >= СотрудникиМесяцы.ДатаНачала)
			И (СостоянияСотрудниковСрезПоследних.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Увольнение))
			И (СостоянияСотрудниковСрезПоследних.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Работа))
			И (СостоянияСотрудниковСрезПоследних.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.РаботаВОтпускеПоУходуЗаРебенком))

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Сотрудники.Сотрудник,
	СостоянияСотрудников.Состояние,
	СостоянияСотрудников.Период,
	ВЫБОР
		КОГДА СостоянияСотрудников.ДействуетДо = ДАТАВРЕМЯ(1, 1, 1)
				ИЛИ СостоянияСотрудников.ДействуетДо > Сотрудники.ДатаОкончания
			ТОГДА ВЫБОР
					КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						ТОГДА ДОБАВИТЬКДАТЕ(Сотрудники.ДатаОкончания, ДЕНЬ, 1)
					ИНАЧЕ Сотрудники.ДатаОкончания
				КОНЕЦ
		ИНАЧЕ СостоянияСотрудников.ДействуетДо
	КОНЕЦ,
	СостоянияСотрудников.ВидВремени
ИЗ
	ВТСотрудникиМесяцы КАК Сотрудники
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СостоянияСотрудников КАК СостоянияСотрудников
		ПО Сотрудники.ГоловнойСотрудник = СостоянияСотрудников.Сотрудник
			И (СостоянияСотрудников.Период > Сотрудники.ДатаНачала)
			И Сотрудники.ДатаНачала <= СостоянияСотрудников.Период
			И (ДОБАВИТЬКДАТЕ(Сотрудники.ДатаОкончания, ДЕНЬ, 1) >= СостоянияСотрудников.Период)
			И (СостоянияСотрудников.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Увольнение))
			И (СостоянияСотрудников.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Работа))
			И (СостоянияСотрудников.Состояние <> ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.РаботаВОтпускеПоУходуЗаРебенком))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НормаВремени.Сотрудник КАК сотрудник,
	НормаВремени.Дата КАК Дата,
	СУММА(НормаВремени.ДниПлан) КАК ДниПлан,
	СУММА(НормаВремени.ЧасыПлан) КАК ЧасыПлан
ПОМЕСТИТЬ ВТНормаИтоги
ИЗ
	ВТНормаВремени КАК НормаВремени

СГРУППИРОВАТЬ ПО
	НормаВремени.Сотрудник,
	НормаВремени.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СостоянияСотрудников.Сотрудник КАК Сотрудник,
	ДатыСостояний.Дата КАК Дата,
	ВЫБОР
		КОГДА НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени ЕСТЬ NULL
				И НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Выходной
				И НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Праздники
			ТОГДА ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени
		КОГДА (ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Выходной
					И ЕСТЬNULL(НормаВремениСотрудников.ДниПлан, 0) = 0
				ИЛИ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Праздники)
				И (НЕ СоответствиеСостоянийСотрудниковДаннымУчетаВремени.ВидВремени В (&ВидыВремениСплошнойРегистрации)
					И &ВыделятьВыходныеВПериодыОтклонений)
			ТОГДА ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени
		КОГДА СостоянияСотрудников.ВидВремени <> ЗНАЧЕНИЕ(Справочник.ВидыИспользованияРабочегоВремени.ПустаяСсылка)
			ТОГДА СостоянияСотрудников.ВидВремени
		ИНАЧЕ СоответствиеСостоянийСотрудниковДаннымУчетаВремени.ВидВремени
	КОНЕЦ КАК ВидУчетаВремени,
	ВЫБОР
		КОГДА НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени ЕСТЬ NULL
				И НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Выходной
				И НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени = &Праздники
			ТОГДА ДанныеУчетаОтклоненийСотрудников.Дней
		ИНАЧЕ 1
	КОНЕЦ КАК Дни,
	ВЫБОР
		КОГДА НЕ ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени ЕСТЬ NULL
				И ДанныеУчетаОтклоненийСотрудников.ВидУчетаВремени <> &Выходной
			ТОГДА ДанныеУчетаОтклоненийСотрудников.Часов
		ИНАЧЕ ЕСТЬNULL(НормаВремениСотрудников.ЧасыПлан, 0)
	КОНЕЦ КАК Часы
ПОМЕСТИТЬ ВТДанныеУчетаВремениПоСостояниям
ИЗ
	ВТСостоянияСотрудников КАК СостоянияСотрудников
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСоответствиеСостоянийВидамУчетаВремени КАК СоответствиеСостоянийСотрудниковДаннымУчетаВремени
		ПО СостоянияСотрудников.Состояние = СоответствиеСостоянийСотрудниковДаннымУчетаВремени.Состояние
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ВидыИспользованияРабочегоВремени КАК ОписаниеВидовВремени
		ПО (СоответствиеСостоянийСотрудниковДаннымУчетаВремени.ВидВремени = ОписаниеВидовВремени.Ссылка)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыСостояний КАК ДатыСостояний
		ПО СостоянияСотрудников.НачалоПериода <= ДатыСостояний.Дата
			И СостоянияСотрудников.ОкончаниеПериода >= ДатыСостояний.Дата
		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеУчетаРабочегоВремениСотрудников КАК ДанныеУчетаОтклоненийСотрудников
		ПО СостоянияСотрудников.Сотрудник = ДанныеУчетаОтклоненийСотрудников.Сотрудник
			И (ДатыСостояний.Дата = ДанныеУчетаОтклоненийСотрудников.Дата)
			И (СоответствиеСостоянийСотрудниковДаннымУчетаВремени.ВидВремени = ДанныеУчетаОтклоненийСотрудников.ОсновноеВремя
				ИЛИ ДанныеУчетаОтклоненийСотрудников.ОсновноеВремя = &Выходной
				ИЛИ ДанныеУчетаОтклоненийСотрудников.ОсновноеВремя = &Праздники
					И СостоянияСотрудников.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.Командировка))
		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаИтоги КАК НормаВремениСотрудников
		ПО СостоянияСотрудников.Сотрудник = НормаВремениСотрудников.сотрудник
			И (ДатыСостояний.Дата = НормаВремениСотрудников.Дата)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ДанныеУчетаРабочегоВремениСотрудников.Сотрудник,
	ДанныеУчетаРабочегоВремениСотрудников.Дата,
	ДанныеУчетаРабочегоВремениСотрудников.ВидУчетаВремени,
	ДанныеУчетаРабочегоВремениСотрудников.Дней,
	ДанныеУчетаРабочегоВремениСотрудников.Часов
ИЗ
	ВТДанныеУчетаРабочегоВремениСотрудников КАК ДанныеУчетаРабочегоВремениСотрудников
		ЛЕВОЕ СОЕДИНЕНИЕ ВТСостоянияСотрудников КАК СостоянияСотрудников
		ПО (СостоянияСотрудников.Сотрудник = ДанныеУчетаРабочегоВремениСотрудников.Сотрудник)
			И (СостоянияСотрудников.НачалоПериода <= ВЫБОР
				КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						И ДанныеУчетаРабочегоВремениСотрудников.ПереходящаяЧастьПредыдущейСмены
					ТОГДА ДОБАВИТЬКДАТЕ(ДанныеУчетаРабочегоВремениСотрудников.Дата, ДЕНЬ, 1)
				ИНАЧЕ ДанныеУчетаРабочегоВремениСотрудников.Дата
			КОНЕЦ)
			И (СостоянияСотрудников.ОкончаниеПериода >= ВЫБОР
				КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						И ДанныеУчетаРабочегоВремениСотрудников.ПереходящаяЧастьПредыдущейСмены
					ТОГДА ДОБАВИТЬКДАТЕ(ДанныеУчетаРабочегоВремениСотрудников.Дата, ДЕНЬ, 1)
				ИНАЧЕ ДанныеУчетаРабочегоВремениСотрудников.Дата
			КОНЕЦ)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТСостоянияСотрудников КАК СостояниеГоловныхСотрудников
		ПО (СостояниеГоловныхСотрудников.Сотрудник = ДанныеУчетаРабочегоВремениСотрудников.Сотрудник.ГоловнойСотрудник)
			И (СостояниеГоловныхСотрудников.НачалоПериода <= ВЫБОР
				КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						И ДанныеУчетаРабочегоВремениСотрудников.ПереходящаяЧастьПредыдущейСмены
					ТОГДА ДОБАВИТЬКДАТЕ(ДанныеУчетаРабочегоВремениСотрудников.Дата, ДЕНЬ, 1)
				ИНАЧЕ ДанныеУчетаРабочегоВремениСотрудников.Дата
			КОНЕЦ)
			И (СостояниеГоловныхСотрудников.ОкончаниеПериода >= ВЫБОР
				КОГДА &ОтноситьПереходящуюЧастьСменыКДнюНачала
						И ДанныеУчетаРабочегоВремениСотрудников.ПереходящаяЧастьПредыдущейСмены
					ТОГДА ДОБАВИТЬКДАТЕ(ДанныеУчетаРабочегоВремениСотрудников.Дата, ДЕНЬ, 1)
				ИНАЧЕ ДанныеУчетаРабочегоВремениСотрудников.Дата
			КОНЕЦ)
ГДЕ
	СостоянияСотрудников.Сотрудник ЕСТЬ NULL
	И СостояниеГоловныхСотрудников.Сотрудник ЕСТЬ NULL
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДанныеУчетаВремениПоСостояниям.Сотрудник КАК Сотрудник,
	ДанныеУчетаВремениПоСостояниям.Дата КАК Дата,
	ВЫБОР
		КОГДА ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени В (&ОсновнойОтпуск, &ДополнительныйОтпуск)
				И ДанныеПроизводственногоКалендаря.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)
			ТОГДА &Выходной
		ИНАЧЕ ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени
	КОНЕЦ КАК ВидУчетаВремени,
	СУММА(ДанныеУчетаВремениПоСостояниям.Дни) КАК Дни,
	СУММА(ДанныеУчетаВремениПоСостояниям.Часы) КАК Часы,
	ПериодыРаботыСотрудников.Организация КАК Организация,
	ПериодыРаботыСотрудников.Подразделение КАК Подразделение,
	ПериодыРаботыСотрудников.Должность КАК Должность
ПОМЕСТИТЬ ПредставленияДанныеУчетаВремениИСостоянийСотрудников
ИЗ
	ВТПериодыРаботыСотрудников КАК ПериодыРаботыСотрудников
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДанныеУчетаВремениПоСостояниям КАК ДанныеУчетаВремениПоСостояниям
		ПО ПериодыРаботыСотрудников.Сотрудник = ДанныеУчетаВремениПоСостояниям.Сотрудник
			И ПериодыРаботыСотрудников.ДатаНачала <= ДанныеУчетаВремениПоСостояниям.Дата
			И ПериодыРаботыСотрудников.ДатаОкончания >= ДанныеУчетаВремениПоСостояниям.Дата
		ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыТерриторий КАК ПериодыДействияТерриторий
		ПО (ДанныеУчетаВремениПоСостояниям.Сотрудник = ПериодыДействияТерриторий.Сотрудник)
			И (ДанныеУчетаВремениПоСостояниям.Дата >= ПериодыДействияТерриторий.ДатаНачала)
			И (ДанныеУчетаВремениПоСостояниям.Дата <= ПериодыДействияТерриторий.ДатаОкончания
				ИЛИ ПериодыДействияТерриторий.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1))
		ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыДействияГрафиковДляКалендарей КАК ПериодыДействияГрафиковДляКалендарей
		ПО (ДанныеУчетаВремениПоСостояниям.Сотрудник = ПериодыДействияГрафиковДляКалендарей.Сотрудник)
			И (ДанныеУчетаВремениПоСостояниям.Дата МЕЖДУ ПериодыДействияГрафиковДляКалендарей.НачалоПериода И ПериодыДействияГрафиковДляКалендарей.КонецПериода)
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГрафикиРаботыСотрудников КАК ГрафикиРаботыСотрудников
		ПО (ПериодыДействияГрафиковДляКалендарей.ГрафикРаботы = ГрафикиРаботыСотрудников.Ссылка)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДанныеПроизводственногоКалендаря КАК ДанныеПроизводственногоКалендаря
		ПО (ГрафикиРаботыСотрудников.ПроизводственныйКалендарь = ДанныеПроизводственногоКалендаря.ПроизводственныйКалендарь)
			И (ДанныеУчетаВремениПоСостояниям.Дата = ДанныеПроизводственногоКалендаря.Дата)

СГРУППИРОВАТЬ ПО
	ДанныеУчетаВремениПоСостояниям.Сотрудник,
	ДанныеУчетаВремениПоСостояниям.Дата,
	ВЫБОР
		КОГДА ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени В (&ОсновнойОтпуск, &ДополнительныйОтпуск)
				И ДанныеПроизводственногоКалендаря.ВидДня = ЗНАЧЕНИЕ(перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)
			ТОГДА &Выходной
		ИНАЧЕ ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени
	КОНЕЦ,
	ПериодыРаботыСотрудников.Организация,
	ПериодыРаботыСотрудников.Подразделение,
	ПериодыРаботыСотрудников.Должность,
	ВЫБОР
		КОГДА ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени В (&ОсновнойОтпуск, &ДополнительныйОтпуск)
				И ДанныеПроизводственногоКалендаря.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)
			ТОГДА &Выходной
		ИНАЧЕ ДанныеУчетаВремениПоСостояниям.ВидУчетаВремени
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник КАК Сотрудник,
	ДанныеУчетаВремениИСостоянийСотрудников.Организация КАК Организация,
	ВЫБОР
		КОГДА &ВыводитьВРазрезеПодразделений
			ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Подразделение
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	КОНЕЦ КАК Подразделение,
	ВЫБОР
		КОГДА ОписаниеВидовВремени.Ссылка = &Явка
			ТОГДА 1
		КОГДА ОписаниеВидовВремени.ОсновноеВремя = &Явка
			ТОГДА 2
		КОГДА ОписаниеВидовВремени.Ссылка = &ВечерниеЧасы
			ТОГДА 3
		КОГДА ОписаниеВидовВремени.ОсновноеВремя = &ВечерниеЧасы
			ТОГДА 3
		КОГДА ОписаниеВидовВремени.Ссылка = &НочныеЧасы
			ТОГДА 5
		КОГДА ОписаниеВидовВремени.ОсновноеВремя = &НочныеЧасы
			ТОГДА 6
		КОГДА ОписаниеВидовВремени.Ссылка = &Сверхурочно
			ТОГДА 7
		КОГДА ОписаниеВидовВремени.ОсновноеВремя = &Сверхурочно
			ТОГДА 8
		ИНАЧЕ 9
	КОНЕЦ КАК ПриоритетВидаВремени,
	НАЧАЛОПЕРИОДА(ДанныеУчетаВремениИСостоянийСотрудников.Дата, МЕСЯЦ) КАК Месяц,
	ДанныеУчетаВремениИСостоянийСотрудников.Должность КАК Должность,
	ДанныеУчетаВремениИСостоянийСотрудников.Часы КАК Часы,
	ДанныеУчетаВремениИСостоянийСотрудников.Дата КАК Дата,
	ВЫБОР
		КОГДА ОписаниеВидовВремени.РабочееВремя
				И ОписаниеВидовВремени.ОсновноеВремя <> ЗНАЧЕНИЕ(Справочник.ВидыИспользованияРабочегоВремени.ПустаяСсылка)
			ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Часы
		ИНАЧЕ 0
	КОНЕЦ КАК РабочиеЧасы,
	ВЫБОР
		КОГДА ОписаниеВидовВремени.РабочееВремя
				И ОписаниеВидовВремени.ОсновноеВремя <> ЗНАЧЕНИЕ(Справочник.ВидыИспользованияРабочегоВремени.ПустаяСсылка)
			ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Дни
		ИНАЧЕ 0
	КОНЕЦ КАК РабочееВремяДни,
	ВЫБОР
		КОГДА ОписаниеВидовВремени.ОсновноеВремя = &ВыходнойДень
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ЭтоВыходнойДень,
	ОписаниеВидовВремени.Ссылка КАК ВидУчетаВремени,
	ОписаниеВидовВремени.ОсновноеВремя КАК ОсновноеВремя,
	ПредставленияКадровыеДанныеСотрудников.ФИОПОЛНЫЕ КАК ФИОПолные,
	ПредставленияКадровыеДанныеСотрудников.ФАМИЛИЯИО КАК ФамилияИО,
	ОписаниеВидовВремени.БуквенныйКод КАК ВидУчетаВремениБуквенныйКод,
	ОписаниеВидовВремени.ОсновноеВремя КАК ВидУчетаВремениОсновноеВремя,
	ОписаниеВидовВремени.РабочееВремя КАК ВидУчетаВремениРабочееВремя,
	ОписаниеВидовВремени.Целосменное КАК ВидУчетаВремениЦелосменное,
	ДанныеУчетаВремениИСостоянийСотрудников.Должность.Наименование КАК ДолжностьНаименование,
	ДанныеУчетаВремениИСостоянийСотрудников.Организация.КодПоОКПО КАК ОрганизацияКодПоОКПО,
	ДанныеУчетаВремениИСостоянийСотрудников.Организация.НаименованиеПолное КАК ОрганизацияНаименованиеПолное,
	(ВЫБОР
		КОГДА &ВыводитьВРазрезеПодразделений
			ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Подразделение
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	КОНЕЦ).Наименование КАК ПодразделениеНаименование,
	ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник.Код КАК СотрудникКод,
	ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник.Наименование КАК СотрудникНаименование,
	ВЫБОР
		КОГДА ДанныеУчетаВремениИСостоянийСотрудников.Организация.Наименование ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ОрганизацияНаименованиеПолеУпорядочивания1,
	ДанныеУчетаВремениИСостоянийСотрудников.Организация.Наименование КАК ОрганизацияНаименование,
	ВЫБОР
		КОГДА (ВЫБОР
				КОГДА &ВыводитьВРазрезеПодразделений
					ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Подразделение
				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
			КОНЕЦ).Наименование ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ПодразделениеНаименованиеПолеУпорядочивания1,
	ВЫБОР
		КОГДА ДанныеУчетаВремениИСостоянийСотрудников.Организация.Ссылка ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ОрганизацияПолеУпорядочивания1,
	ВЫБОР
		КОГДА (ВЫБОР
				КОГДА &ВыводитьВРазрезеПодразделений
					ТОГДА ДанныеУчетаВремениИСостоянийСотрудников.Подразделение
				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
			КОНЕЦ).Ссылка ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ПодразделениеПолеУпорядочивания1,
	ВЫБОР
		КОГДА ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник.Наименование ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК СотрудникНаименованиеПолеУпорядочивания1,
	ВЫБОР
		КОГДА ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник.Ссылка ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК СотрудникПолеУпорядочивания1,
	ВЫБОР
		КОГДА ПредставленияКадровыеДанныеСотрудников.ФАМИЛИЯИО ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ФамилияИОПолеУпорядочивания1,
	ВЫБОР
		КОГДА ПредставленияКадровыеДанныеСотрудников.ФИОПОЛНЫЕ ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ФИОПолныеПолеУпорядочивания1,
	ВЫБОР
		КОГДА ДанныеУчетаВремениИСостоянийСотрудников.Должность.Ссылка ЕСТЬ NULL
			ТОГДА 0
		ИНАЧЕ 1
	КОНЕЦ КАК ДолжностьПолеУпорядочивания1
ИЗ
	ПредставленияДанныеУчетаВремениИСостоянийСотрудников КАК ДанныеУчетаВремениИСостоянийСотрудников
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников
		ПО ДанныеУчетаВремениИСостоянийСотрудников.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ВидыИспользованияРабочегоВремени КАК ОписаниеВидовВремени
		ПО ДанныеУчетаВремениИСостоянийСотрудников.ВидУчетаВремени = ОписаниеВидовВремени.Ссылка
ГДЕ
	ДанныеУчетаВремениИСостоянийСотрудников.ВидУчетаВремени <> &РабочееВремя

УПОРЯДОЧИТЬ ПО
	ОрганизацияНаименованиеПолеУпорядочивания1,
	ОрганизацияНаименование,
	ПодразделениеНаименованиеПолеУпорядочивания1,
	ПодразделениеНаименование,
	Месяц,
	ОрганизацияПолеУпорядочивания1,
	ОрганизацияНаименование,
	Организация,
	ПодразделениеПолеУпорядочивания1,
	ПодразделениеНаименование,
	Подразделение,
	СотрудникНаименованиеПолеУпорядочивания1,
	СотрудникНаименование,
	СотрудникПолеУпорядочивания1,
	СотрудникНаименование,
	Сотрудник,
	ФамилияИОПолеУпорядочивания1,
	ФамилияИО,
	ФИОПолныеПолеУпорядочивания1,
	ФИОПолные,
	ДолжностьПолеУпорядочивания1,
	ДолжностьНаименование,
	Должность,
	Дата,
	ОрганизацияНаименованиеПолеУпорядочивания1,
	ОрганизацияНаименование,
	ПодразделениеНаименованиеПолеУпорядочивания1,
	ПодразделениеНаименование,
	Месяц,
	СотрудникНаименованиеПолеУпорядочивания1,
	СотрудникНаименование,
	ПриоритетВидаВремени,
	ВидУчетаВремениБуквенныйКод
