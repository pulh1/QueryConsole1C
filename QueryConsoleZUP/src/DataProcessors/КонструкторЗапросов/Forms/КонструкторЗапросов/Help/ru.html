<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="content-type" content="text/html;charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link></head><body>

<h1>Конструктор запросов</h1>
<p class="Usual">С помощью конструктора запросов производится формирование нового и редактирование имеющегося запроса.</p>
<p class="Usual">Для редактирования имеющегося запроса в модуле, содержащем текст запроса, установите курсор в любом месте текста запроса и выберите <strong>Текст - Конструктор запросов</strong> или <strong>Текст - Конструктор запросов с обработкой результата</strong>. </p>
<p class="Usual">Для создания нового запроса установите курсор в модуле в месте, в котором предполагается расположить текст запроса и выберите <strong class="ControlElement">Текст - Конструктор запросов</strong> или <strong>Текст - Конструктор запросов с обработкой результата</strong>. </p>
<p class="Usual">На экран выводится конструктор запросов.</p>
<p class="Usual">С помощью кнопки<strong> Упорядочить список</strong>, расположенной над списком База данных, можно упорядочить список объектов. Повторное нажатие кнопки отменяет упорядочивание.</p>
<p class="Usual">С помощью кнопки <strong>Отображать таблицы изменений</strong> можно отобразить таблицы изменений объектов конфигурации в списке объектов в виде отдельных веток <strong>&lt;ИмяОбъекта&gt;.Изменения</strong>. Повторное нажатие кнопки скроет такие ветки в списке.</p>
<p class="Usual">Для того чтобы создать вложенный запрос, нужно нажать кнопку Создать вложенный запрос. В открывшемся конструкторе запроса сформировать требуемый запрос и нажать кнопку <strong>ОК</strong>. Вложенный запрос отобразится в списке <strong>Таблицы</strong>.</p>
<p class="Usual">С помощью кнопок <strong class="ControlElement">Далее &gt;</strong> последовательно пройдите по закладкам и выберите необходимые исходные данные, укажите группировки и условия, установите нужный порядок и опишите итоговые данные. В результате работы конструктора будет создана форма и макет, которые будут располагаться на соответствующих ветвях. </p>
<p class="Usual">Для корректировки данных используйте кнопку <strong class="ControlElement">&lt; Назад</strong>.</p>
<p class="Usual"> </p>
<ul><li>
<div>На закладке <strong class="ControlElement">Таблицы и поля</strong> в разделе <strong>База данных</strong> выберите нужные объекты и перенесите их в раздел <strong>Таблицы</strong> и <strong>Поля</strong>. Для указания дополнительных условий можно воспользоваться режимом формирования произвольных выражений в запросе. Для этого в списке <strong>Поля</strong> контекстного меню выберите пункт <strong>Добавить</strong>. На экран выводится окно произвольного выражения.<br>В нижнем поле конструктора произвольного выражения формируется текст выражения. Выражение можно набирать с помощью клавиатуры. Для удобства ввода наименований реквизитов можно перетаскивать мышью нужные поля из списка полей и выбирать нужные функции языка запросов из списка, также перетаскивая их мышью в поле ввода выражения.<br>Если указано несколько таблиц, то в форму конструктора запроса добавляется закладка <strong class="ControlElement">Связи</strong>.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Связи</strong> формируются условия, которые накладываются на связи между полями таблиц. Для ввода нового условия нужно нажать кнопку <strong>Добавить</strong> и в колонке <strong>Таблица1 </strong>выбрать одну из таблиц; в колонке <strong>Таблица2</strong> выбрать таблицу, поля которой связаны с полями первой. Ниже списка условий расположены элементы управления, с помощью которых формируется условие связи таблиц.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Группировка</strong>, если требуется, выберите реквизиты, по которым будет выполнена группировка.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Условия</strong>, если требуется, укажите условия, по которым будет выполняться отбор исходных данных. По каждому выбранному полю необходимо выбрать вид условия и указать наименование параметра. Если флажок <strong>Произвольное</strong> установлен, то можно воспользоваться окном формирования произвольных выражений</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Условия</strong> при необходимости формируются дополнительные параметры запроса: указывается выборка записей и тип запроса, а также таблицы, которые требуется заблокировать для последующего изменения.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Дополнительно</strong> указываются дополнительные условия.<br>Если на закладке <strong class="ControlElement">Дополнительно</strong> выбрано создание временной таблицы, то на появившейся закладке Индекс можно будет выбрать поля, по которым будет построен индекс.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Объединения/Псевдонимы</strong>, если требуется, выберите реквизиты, по которым будет выполнена группировка. В таблице показано соответствие выбранных полей и исходных данных. Имена полей и соответствие можно изменить. Для изменения имени выберите поле и нажмите клавишу <strong class="ShortCut">Enter</strong>, введите новое имя поля. Для изменения соответствия в колонке Запрос выберите нужную строку и нажмите клавишу <strong class="ShortCut">Enter</strong>. В выпадающем списке выберите нужное значение. <br>Если требуется выбрать только уникальные значения, то следует установить флажок в колонке <strong>Без дубл</strong>.<br>Псевдонимы полей, которые изменены пользователем, или были загружены из текста запроса, или при генерации псевдонима конструктор определил, что данный псевдоним обязателен, выделяются жирным шрифтом.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Порядок</strong>, если требуется, укажите порядок вывода полученной информации.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Итоги</strong>, если требуется, укажите, по каким полям требуется выводить промежуточные итоговые данные, а также общие итоги.<br>При нажатии кнопки <strong>&gt;&gt;</strong>, расположенной рядом с групповыми полями, в поля для группировки будут помещены все ссылочные поля. При нажатии кнопки <strong>&gt;&gt;</strong>, расположенной рядом с суммируемыми полями, в список суммируемых полей будут помещены все поля, имеющие числовой тип.</div>
</li>
<li>
<div>На закладке <strong class="ControlElement">Пакет запросов</strong> при работе с пакетными запросами создается последовательность запросов пакета. Каждый запрос редактируется и настраивается в этом же окне, а на всех предыдущих закладках можно переключаться между настраиваемыми запросами с помощью закладок, расположенных вдоль правой стороны конструктора запросов.</div></li>
<li>На закладке <strong class="ControlElement">Обработка результата</strong> производится настройка вывода результата. <br>Укажите тип обработки данных: обход результата, вывод в табличный документ или диаграмму. В зависимости от выбранного представления в конструктор будет добавлена соответствующая страница настройки. <br>Для табличного документа укажите способ размещения группировок и реквизитов. Смысл настроек понятен из поясняющих надписей.<br>Для диаграмм выберите вид диаграммы.</li>
</ul><p></p>
<div></div>
<p class="Usual">Если вывод осуществляется в табличный документ, то в объекте метаданных, в модуле которого или модуле формы которого он вызывается, создается макет для вывода в табличный документ. Макет модифицируется при повторном вызове конструктора. Данный макет удаляется, если ранее конструктор предназначался для вывода в табличный документ, а после редактирования конструктором вывод был выбран другой способ вывода. Для общих модулей создаются общие макеты.</p>
<p class="Usual">Для удобства разработки в каждой колонке на каждой закладке обработки предусмотрена возможность поиска значения (<strong class="ShortCut">Ctrl + F</strong>) и отмены поиска значения (<strong class="ShortCut">Ctrl+Q</strong>), команды доступны в контекстном меню колонки.</p>
<p class="Usual">В любой момент создания запроса текст запроса можно просмотреть, нажав кнопку <strong>Запрос</strong>.</p>
<h2>Редактирование запроса схемы компоновки данных</h2>
<p>Если конструктор запросов вызывается в режиме компоновки данных, то в конструктор добавляются закладки <strong>Компоновка данных</strong> и <strong>Характеристики</strong>. </p>
<ul><li>На закладке <strong>Компоновка данных</strong> описываются настройки компоновки данных: 
</li>
<ul><li>На закладке <strong>Таблицы</strong> отображаются выбранные в текущем запросе таблице с указанной на закладке <strong>Связи</strong> иерархией. <br><b>Обязательная</b> - если таблица не соединена с другими, то такая группа всегда обязательная. Для всех остальных флажок в колонке <b>Обязательная</b> можно снять.<br><b>Начало группы</b> - если флажок установлен (только для необязательных таблиц) и таблица является первой на своем уровне иерархии или первой после обязательной таблицы, то таблица является началом группы.<br>При нажатии кнопки <b>Параметры компоновки данных</b> откроется форма установки параметров компоновки данных для таблицы.</li></ul><ul><li>На закладке <b>Поля</b> выбираются поля, которые будут использованы в качестве полей выбора компоновки данных. <b>Использовать реквизиты - </b>признак использования подчиненных элементов для поля, указанного в выражении. Флажок может быть установлен только в том случае, если выражение содержит имя доступного поля схемы запроса.</li>
<li>На закладке <b>Условия</b> выбираются поля, которые будут использованы в выражениях отбора компоновки данных. <b>Использовать реквизиты - </b>признак использования подчиненных элементов для поля, указанного в выражении. Флажок может быть установлен только в том случае, если выражение содержит имя доступного поля схемы запроса.</li></ul><li>
<div>На закладке <strong class="ControlElement"><font color="#000000">Характеристики</font></strong> описываются желаемые характеристики. 
<ul><li>
<div>В колонке <font color="#000000"><strong>Тип</strong></font> укажите тип того поля, к которому будет относиться описываемая характеристика. В колонке <strong class="ControlElement"><font color="#000000">Источник видов</font></strong> выберите, будет ли список характеристик получен из таблицы базы данных или результата запроса. В поле <strong class="ControlElement"><font color="#000000">Виды характеристик</font></strong> выберите желаемую таблицу или, в случае выбора запроса в качестве источника, создайте запрос с помощью конструктора запроса. В колонке <strong class="ControlElement"><font color="#000000">Поле имени</font></strong> выберите поле, содержащее имя характеристики. В колонке <strong><font color="#000000">Поле типа значения</font></strong> выберите поле, содержащее тип значения характеристики. При выборе в этой колонке пустого значения считается, что характеристика имеет такой же тип, как у поля <strong class="ControlElement"><font color="#000000">Поле значения</font></strong>, содержащего значение характеристики. Если поле значения характеристики не указано, то считается, что характеристика имеет тип <strong><font color="#000040">Булево</font></strong>.</div>
</li>
<li>
<div>Во второй колонке <strong class="ControlElement"><font color="#000000">Источник значений</font></strong> укажите откуда будет получен список значений характеристик. В колонке <strong class="ControlElement"><font color="#000000">Значения характеристик</font></strong> укажите имя таблицы или запрос для получения значений характеристик. В колонке <strong>Поле объекта</strong> выберите поле, содержащее идентификатор объекта. В колонке <strong class="ControlElement"><font color="#000000">Поле вида</font></strong> выберите поле, содержащее идентификатор характеристики. В колонке <strong class="ControlElement"><font color="#000000">Поле значения</font></strong> выберите поле, содержащее значение характеристики. При выборе пустого значения в этой колонке, значение характеристики будет равно <strong class="ControlElement"><font color="#000000">Истина</font></strong> в том случае, если такая характеристика у объекта есть, <strong class="ControlElement"><font color="#000000">Ложь</font></strong> – в противном случае.</div></li></ul></div></li></ul><p class="Usual"> </p>
<p class="Usual"> </p></body></html>